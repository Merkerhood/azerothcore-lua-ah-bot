-------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------
--
-- Welcome to mostlynick's Eluna AH Bot :)
--
-- Features: * Plug and Play *, * Extensive filters *, * Buyer *, * Seller *, * Both bids and buyouts *, * and more *
-- This module is compatible with all Eluna versions that support async DB queries.
-- Made for Yggdrasil WotLK / AzerothCore. 
-- You may freely use this file for emulation purposes. It is released under this repository's AGPL v3 license: <link>
--
-------------------------------------------------------------------------------------------------------------------------
-- AH Bot Configs
-------------------------------------------------------------------------------------------------------------------------

local EnableAHBot			= true			-- Default: True. If false, AH bot is disabled. 
local AHBots				= {1, 2, 3, 4}	-- Default: 1, 2, 3, 4. Chooses which player GUID lows will be used as AH bots. Must match extant characters. Not faction specific.
local EnabledAuctionHouses	= {2, 6}		-- Default: 2, 6, 7. Possible values: 2 is ally, 6 is horde, 7 is cross faction (neutral). Multiple values accepted, like {2, 6, 7}. Only 7 is required on cross-faction servers.
local AHBotActionDebug		= true			-- Default: False. Enables various action debug prints. Critical prints will still be active even if false.
local AHBotItemDebug		= false			-- Default: False. Enables debug prints on item handling, cost per item entry, Quality, etc.
local ActionsPerCycle		= 500			-- Default: 500 (items). The higher the value, the faster the bots fill the AH up to the min auctions limit and the more items they buy, at the expense of performance.
local StartupDelay 			= 1000			-- Default: 1000 (ms). Delay after startup/Eluna reload before the auction house initializes. Having this set to 0 will cause lag on initial world load. 
local EnableGMMessages		= true			-- Default: True. Messages all online GMs on command and initiation events.
local AnnounceOnLogin		= true			-- Default: True. Announces to all players on login that this server runs the Eluna AH Bot module.

-------------------------------------------------------------------------------------------------------------------------
-- Buyer Configs
-------------------------------------------------------------------------------------------------------------------------

local EnableBuyer			= true			-- Default: True.
local AHBuyTimer 			= 0.5 			-- Default: 0.5 (hours). How often the AH bot will try to purchase a few items.
local ItemLevelLimit 		= 187			-- Default: 187. Prevents bots from buying items above this item level, to ensure players get access to those items instead.
local BotsBuyFromBots		= false			-- Default: False. Prevent bots from buying other bots' items.
local CostFormula 			= 1     		-- Default: 1. 1 = Quality based scaling, 2 = Entry ID influenced, 3 = Quality/Level focused, 4 = Balanced multi-factor, 5 = Progressive thresholds, 6 = Random (1000-1000000)
local BotsPriceTolerance	= 1.5			-- Default: 1.5. Factor with which unadjusted CostFormula is multiplied to return how much a bot is willing to pay for an item. 
local PlaceBidChance		= 20			-- Default: 10 (%). Setting to 0 disables bids. 
local PlaceBuyoutChance		= 10			-- Default: 5 (%). Settings to 0 disables buyouts.
local BuyOnStartup			= true			-- Default: True. Ibid SellOnStartup. 
local DisableBidFight		= true			-- Default: True. Don't place bids/buyouts on items that players have already placed bids on

-------------------------------------------------------------------------------------------------------------------------
-- Seller Configs
-------------------------------------------------------------------------------------------------------------------------

local EnableSeller			= true			-- Default: True.
local MaxAuctions 			= 10000			-- Default: 5000. Max number of auctions posted by the AH bot.
local MinAuctions			= 2000	 		-- Default: 2000. Min number of auctions. If under this value, AH will repopulate sales. If over, but less than max, has 30% chance per check to populate AH.
local RepopulationChance	= 30			-- Default: 30. Percentage chance to partially restock AH if stock is between max and min during a periodical check. Can be overriden to force populate whenever with ".ahbot auctions add". 
local CostFormula 			= 1 	    	-- Default: 1. 1 = Quality based scaling, 2 = Entry ID influenced, 3 = Quality/Level focused, 4 = Balanced multi-factor, 5 = Progressive thresholds, 6 = Random (1000-1000000)
local SellPriceVariance		= 20			-- Default: 20. How many % to randomize prices with. 
local AHSellTimer 			= 5 			-- Default: 5 (hours). How often the AH bot will check whether it needs to put up new auctions, in hours.
local SellOnStartup			= true			-- Default: True. Used for debugging and instantly populating an empty auction house. If true, fires AH bot on Eluna load (startup / Eluna reloads). If false, activates on AHSellTimer. 
local ApplyRandomProperties = true			-- Default: True. Adds enchant/random stats and corresponding name to items (e.g., "of the Eagle"). This is DBC-based with Lua tables copied into this script. Disable if non-WotLK core.
local SetAsCraftedBy		= true			-- Default: True. Marks items created by player spells as created by the AH bot posting the item.

-------------------------------------------------------------------------------------------------------------------------
-- Item Seller Filter Configs
-------------------------------------------------------------------------------------------------------------------------

-- General Item Filters
local EnableItemFilters		= true								-- Default: True. Disable only for debugging.
local AllowDeprecated 		= false								-- Default: False. Items with flag 16 (Deprecated) or name like NPC, zzOLD, etc. will not be sold.
local AllowedBinds 			= {0, 2, 3} 						-- Default: 0, 2, 3. 0 = no bounds, 1 = Bind on Pickup, 2 = Bind on Equip, 3 = Bind on Use, 4-5 Quest Items (see also AllowQuestItems to control quest item sales).
local AllowBindOnAccount	= false								-- Default: False. Decides whether BoA items (e.g., hierlooms) can be sold by the AH bot.
local AllowedQualities		= {1, 2, 3, 4}						-- Default: 1, 2, 3, 4. 0 = Gray/Poor, 1 = White/Common, 2 = Green/Uncommon, 3 = Blue/Rare, 4 = Purple/Epic, 5 = Orange/Legendary, 6 = Red/Artifact, 7 = Gold/Heirloom.
local AllowQuestItems		= false								-- Default: False.
local AllowConsumables		= true								-- Default: True. Toggles selling consumables (potions, elixirs, etc.).
local MinContainerSize		= 16								-- Default: 16. Don't allow selling containers (including quivers, bags, etc.) under specified size.
local MinLevelConsumables	= 50								-- Default: 50. Prevents the AH bot from flooding the market with low level junk.
local MinLevelGear			= 10								-- Default: 10. Prevents the AH bot from flooding the market with low level junk and unobtainable starter items.
local StackedItemClasses	= {0, 5, 6, 7}						-- Default: 0, 5, 6, 7. Sells stacks between 50-100% of max stack size. Possible values: 0 (Consumable), 1 (Container), 2 (Weapon), 3 (Gem), 4 (Armor), 5 (Reagent), 6 (Projectile), 7 (Trade Goods), 9 (Recipe), 11 (Quiver), 12 (Quest), 13 (Key) 15 (Miscellaneous), 16 (Glyph).
local AlwaysMaxStackAmmo	= true								-- Default: True. If true, always sells ammo in stacks of 1000.
local AdjustedAmmoPrices 	= true								-- Default: True. Ammo price variables are inconsistent. This adjusts ammunition prices to realistic in-game prices. For example, Iceblade Arrows are set to between 20g-35g per stack.
local AllowCommonAmmo		= false								-- Defualt: False. Common ammo is just dead weight.
local AllowReputationItems 	= false								-- Default: False.
local AllowMounts			= false								-- Default: False. If true, the X-51 rocket has a tendency to show up.
local AllowCompanions		= true								-- Default: True. 

-- Character and Race Filters
local AllowedClassItems		= {-1} 									-- Default: -1. Possible values: -1 (Items with no class restrictions), 1 (Warrior), 2 (Paladin), 3 (Hunter), 4 (Rogue), 5 (Priest), 6 (DK), 7 (Shaman), 9 (Warlock), 11 (Druid). Table accepts multiple values, such as {-1, 1, 2, 3}.
local AllowedAllyRaces		= {-1, 1, 4, 8, 64, 1024, 2147483647}	-- Default: -1, 1, 4, 8, 64, 1024, 2147483647 (All races and all raceless items). Possible values: 1 (Human), 2 (Orc), 4 (Dwarf), 8 (Night Elf), 16 (Undead), 32 (Tauren), 64 (Gnome), 128 (Troll), 512 (Blood Elf), 1024 (Draenei), -1 and 2147483647 (all races).
local AllowedHordeRaces		= {-1, 2, 16, 32, 128, 512, 2147483647}	-- Default: -1, 2, 16, 32, 128, 512, 2147483647 (All races and all raceless items). Possible values: 1 (Human), 2 (Orc), 4 (Dwarf), 8 (Night Elf), 16 (Undead), 32 (Tauren), 64 (Gnome), 128 (Troll), 512 (Blood Elf), 1024 (Draenei), -1 and 2147483647 (all races).

-- Profession Filters
local AllowedProfessions 	= {8, 16, 32, 64, 128, 512, 1024} 	-- Default: 8, 16, 32, 64, 128, 512, 1024. Possible values: 8 (Leatherworking Supplies), 16 (Inscription Supplies), 32 (Herbs), 64 (Enchanting Supplies), 128 (Engineering Supplies), 512 (Gems), 1024 (Mining Supplies).
local AllowLockpicking		= true								-- Default: True. Toggles lockboxes, etc.
local AllowGlyphs			= true								-- Default: True. Toggles selling glyphs.
local AllowRecipes			= true								-- Default: True. Toggles profession recipes.
local RecipePriceAdjustment = 10								-- Default: 10. Factor to increase recipe prices by. These are usually low in price because their associated variables are low. Set to false to disable.
local GemPriceAdjustment	= 0.142								-- Default: 1/7. Factor to decrease gem prices by. These are usually high in price because their associated variables are high. Set to false to disable.
local UndervaluedItemAdjust	= 5									-- Default: 5. Vellums, Titanium materials, VIII scrolls etc. are usually somewhat undervalued. Set to false to disable.
local LowPriceFloor			= 200000							-- Default: 200000 (20g). Price floor for certain items where multipliers don't work well. Companions, glyphs, etc. Randomized +- 30% around this base cost. If nil, defaults to UndervaluedItemAdjust.

-- Misc Config
local AllowKeys				= false								-- Default: False.
local AllowMisc				= false								-- Default: False. If enabled, allows Soul Shards, Currency Tokens and "Misc Other" items (item_template class 15, subclass 4).
local AllowJunk				= true								-- Default: True. Toggles junk, such as fishing boxes.
local AllowHolidayItems		= false								-- Default: False. Toggles holiday/seasonal items.
local AllowConjured			= false								-- Default: False. Toggles conjured items like mage strudels.

-- Seller Item Weights
-- The weight is always relative to the total set and number of items in the category.
-- The way it works is that it feeds all the items of the class X times into the weight tables,
-- increasing the bool we can pick items from with duplicates of higher weighted categories.
-- Increasing one value will supplant the value of the other values.
local ItemWeights = {
    Gear = {
        ["Gray/Poor"] 			= 0,
        ["White/Common"] 		= 0.1,
        ["Green/Uncommon"] 		= 25,
        ["Blue/Rare"]			= 15,
        ["Purple/Epic"] 		= 5,
        ["Orange/Legendary"] 	= 0,
        ["Red/Artifact"] 		= 0,
        ["Gold/Heirloom"]		= 0
    },
    Mats = {
        ["Gray/Poor"] 			= 0,
        ["White/Common"] 		= 2,
        ["Green/Uncommon"] 		= 30,
        ["Blue/Rare"] 			= 10,
        ["Purple/Epic"] 		= 1,
        ["Orange/Legendary"] 	= 0,
        ["Red/Artifact"] 		= 0,
        ["Gold/Heirloom"]		= 0
    },
    Glyph = 10,
    Projectile = 5,
    Other = 20,
}

-- Customizable item ID filters
local AlwaysSellIDs			= {}								-- Default: Nil. Not implemented.

local NeverSellIDs			= {									-- Default: Various items not intended for AH sale. Append list by adding new "<item_entry>," rows. 
							   52252, -- Lightbringer Tabard	-- The SQL name list below works as well, though this is better to use in case of overlapping item names,
							   44663, -- Adventurer's Satchel   -- or when you have the item ID readily available
							   54822, -- Sen'Jin's Overcloak
							   37201, -- Corpse Dust
							   17195, -- Fake Mistletoe
							   44432, -- China Glyph of Raise Dead??
							   -- Deprecated Classic mounts below
							   1041, 1133, 1134, 2413, 2415, 5663, 5874, 5875, 
							   8583, 8589, 8590, 8627, 8628, 8630, 8633, 14062,
							   -- Add more item IDs if needed
							   }

-------------------------------------------------------------------------------------------------------------------------
-- Do not edit below this line unless you know what you're doing
-------------------------------------------------------------------------------------------------------------------------

if not EnableAHBot then return end

-------------------------------------------------------------------------------------------------------------------------
-- Helper functions, tables, etc.
-------------------------------------------------------------------------------------------------------------------------

local itemCache = {}										-- Stores all entries from the item_template for further processing
local NextAHBotSellCycle = os.time() + AHSellTimer * 60 * 60-- Used in print and cmd feedback
local AHBotSellEventId										-- Used to track if running, for cmd etc
local AHBotBuyEventId										-- Used to track if the indefinite Lua event for the AH bot is running, to not schedule another on top through the cmd system
local botList = table.concat(AHBots, ",") 					-- Converts table to a string for SQL and concat interaction
local houseList = table.concat(EnabledAuctionHouses, ",")	-- Converts table to a string for SQL and concat interaction
local postedAuctions = {} 									-- Counts how many auctions have been posted by the auction bots last. Used in info cmd

function SendMessageToGMs(message)
    for _, player in pairs(GetPlayersInWorld()) do
        if player:GetGMRank() > 0 then
			if not EnableGMMessages then
				if tonumber(message) ~= nil then RemoveEventById(message) end -- If GM messages are off, remove any events in the GM message handler (identified by msg var being number)
				return
			end
			if tonumber(message) ~= nil then player:SendBroadcastMessage("|cFFFF0000 [Eluna AH Bot GM]: Fatal error - No valid bots configured! |r")
			else player:SendBroadcastMessage("|cFFD8D8E6[Eluna AH Bot GM]|r: "..message)
			end
        end
    end
end

local function queryBotCharacters() -- Verifies bots' existence
    local result = CharDBQuery("SELECT guid FROM characters WHERE guid IN (" .. botList .. ")")
    if not result then CreateLuaEvent(SendMessageToGMs, 15 * 60 * 1000, 0) error("[Eluna AH Bot]: Core - No valid bots found!") end -- Notify GMs every 15 minutes if enabled with erroneous AH bot setup

    local validGUIDs = {}

    repeat
        table.insert(validGUIDs, result:GetUInt32(0))
    until not result:NextRow()
	
    if #validGUIDs < #AHBots then
        print("[Eluna AH Bot]: Error in selected bot list "..botList..", bot(s) not found! Defaulting to "..table.concat(validGUIDs, ",")..".")
		SendMessageToGMs("Error in bot list "..botList.."! Defaulting to "..table.concat(validGUIDs, ",")..".")
        AHBots = validGUIDs
		botList = table.concat(AHBots, ",")
    end
	print("[Eluna AH Bot]: AH bot module loaded. Type '.ahbot' in game to manage, set cache settings, and display statistics.")
end

queryBotCharacters()

-- Static table of crafted items that can be assigned bot's name as crafter.
-- There's no convenient way of getting this from the database as it's set by the spell.dbc. For servers that don't have the spell_dbc database-loaded, we need to have a cached table for reference. 
local craftedItems = { 
5349,1113,5232,5514,1450,1114,6265,2302,2304,2303,2305,2306,2307,2308,2300,2309,2310,2311,2312,2313,2314,2315,2316,2317,2454,118,2455,2456,3390,2458,2459,2460,858,41191,2568,2569,2570,2572,2575,2576,2577,2578,2579,2580,2582,2583,2584,2585,2587,2679,
2680,2681,2684,724,733,2683,2682,2687,1082,2685,1017,2840,2842,2841,2862,2851,2852,2853,2854,2863,2857,2864,2865,2866,2867,2868,2869,2871,2870,2844,2845,2847,2848,2849,2850,2888,2318,2996,2997,1625,3239,3240,3241,3382,3383,3384,3385,3386,3387,3388,
3389,3391,2457,1251,2581,3530,3531,3487,3488,3489,3490,3491,3492,3576,3575,3577,3469,3470,3471,3472,3473,3474,3478,3480,3481,3482,3483,3484,3485,3486,3662,3220,3663,3664,3665,3666,3726,3727,3728,3729,929,3823,3824,3825,3826,3827,3828,3829,3848,3849,
3850,3851,3852,3853,3854,3855,3856,3835,3836,3837,3840,3841,3842,3843,3844,3845,3846,3847,5513,3859,4237,4238,4239,4240,4241,4242,3719,4243,4244,4246,4247,4248,4249,4250,4251,4252,4253,4254,4255,4256,4257,4258,4259,4260,4262,4264,4265,4245,4231,4233,
4236,4305,4307,4308,4309,4310,4311,4312,4313,4314,4315,4316,4317,4318,4319,4320,4321,4322,4323,4324,4325,4326,4327,4328,4329,4339,4330,4331,4332,4333,4334,4335,4336,4343,4344,4357,4358,8067,4359,4360,4361,4362,4363,4401,4364,8068,4365,4366,4367,4368,
4369,4370,4371,4372,4373,4374,4375,4376,4377,4378,8069,4379,4380,4381,4382,4383,4384,4385,4386,4387,4388,4403,4389,4390,4391,4392,4393,4394,4395,4396,4397,4398,4404,4405,4406,4407,4457,4455,4456,4596,4623,4703,1450,5184,5081,5350,2288,2136,3772,1487,
5455,41170,5472,5473,5474,5476,5477,5478,5479,5480,5507,5525,5527,5526,5540,5541,5542,5639,5645,5646,5631,5633,5634,5739,5762,5763,5766,5770,5764,5765,5780,5781,5782,5783,5868,5957,5958,5961,5962,5963,5964,5965,5966,5996,1710,5997,6038,6042,6043,6040,
6041,6051,6048,6049,6050,6052,6182,6214,38679,38766,6218,38767,38768,6219,38769,38770,38771,6238,6241,6239,6240,6242,6243,6263,6264,38772,38773,6290,787,4592,6316,4593,38774,38775,38776,38777,38778,38779,38780,38781,6339,6350,6338,5095,4594,6370,6371,6372,6373,38782,
38783,38784,38785,38786,6384,6385,6435,6450,6451,6452,6453,6466,6467,6468,5349,6657,6662,4852,6265,6265,6709,6712,6714,6730,6731,6733,6786,6787,6795,6796,6888,6890,5349,7046,7048,7050,7051,7052,7071,7054,7055,7057,7026,7027,7047,7049,7065,7053,7056,7058,
7059,7060,7061,7062,7063,7064,7134,7135,7166,7189,7206,7268,7276,7277,7278,7279,7280,7281,7282,7283,7284,7285,7348,7349,7352,7358,7359,7371,7372,7373,7374,7375,7377,7378,7386,7387,7390,7391,7506,6533,7148,7676,5639,7771,7770,7769,7733,7733,7913,7914,
7915,7916,7917,7963,7964,7966,7965,7918,7919,7920,7921,7922,7924,7967,7925,7926,5060,7927,7928,7938,7929,7930,7931,7969,7932,7933,7934,7935,7939,7970,7936,7937,7955,7956,7957,7958,7941,7942,7943,7945,7954,7944,7961,7946,7959,7947,7960,8007,8008,3860,
6037,8077,8078,8079,8075,8076,8172,8173,8174,8175,8176,8187,8189,8192,8198,8200,8203,8210,8201,8205,8204,8211,8214,8193,8195,8191,8209,8185,8197,8202,8216,8207,8213,8206,8208,8212,8215,8347,8345,8346,8348,8349,8367,8544,8545,128,8708,9240,9254,6149,
8949,8951,8956,9030,9036,9060,9061,3928,9144,9149,9154,9155,9172,9179,9088,9187,9197,9206,9210,9264,9224,9233,3577,6037,9280,9284,9282,9281,9306,9316,9365,9366,9372,6265,8585,9440,9441,9438,9593,9718,10045,10046,10047,10048,9998,9999,10001,10002,10003,10004,
10007,10008,10009,10056,10010,10011,10052,10050,10018,10019,10020,10042,10021,10023,10024,10026,10027,10054,10028,10053,10029,10051,10055,10030,10031,10032,10033,10034,10025,10038,10044,10035,10039,10040,10041,10036,10423,10421,128,128,10589,10558,10505,10507,10499,10559,10498,10560,10500,10508,
10512,10546,10561,10514,10501,10592,10510,10502,10518,10506,10503,10562,10548,10513,10504,10576,10644,10577,10542,10543,10579,10580,10585,10662,10586,10587,10588,10645,10646,10691,10692,10693,10694,10713,10545,10716,10719,10720,10721,10723,10724,10725,10726,10727,10818,10841,10577,9173,10939,10938,
38787,38788,11024,38789,38790,38791,38792,11082,10998,38793,38794,38795,38796,38797,38798,38799,38800,38801,38802,38803,38804,11130,11131,38805,11135,11134,38806,38807,38808,38809,38810,38811,38812,38813,38814,38815,38816,38817,38818,38819,38820,38821,38822,38823,38824,11145,11149,11175,11174,38825,
38826,38827,38828,38829,38830,38831,38832,38833,38834,38835,38836,38837,38838,38839,11522,38840,38841,38842,38843,38844,38845,38846,38847,38848,38849,38850,38851,11230,11149,11270,11282,11283,11287,11128,11144,11288,11289,11290,11371,5120,11413,8217,8218,5120,5120,5120,5120,11470,11511,9307,
11482,11582,11590,11608,11606,11607,11605,11604,11149,11149,11950,11951,11952,5646,10464,11811,11825,11826,12567,11947,11949,11954,12190,12209,12210,13851,12212,12213,12214,12217,12215,12216,12218,12224,12259,12260,12144,12347,12349,12359,12443,12442,2048,12384,12563,12648,12649,12644,12643,12404,
12405,12406,12408,12416,12428,12424,12415,12425,12624,12645,12409,12410,12418,12631,12419,12426,12427,12417,12625,12632,12414,12422,12610,12611,12628,12633,12420,12612,12636,12640,12429,12613,12614,12639,12620,12619,12618,12641,12723,12764,12769,12772,12773,12774,12775,12776,12777,12779,12781,12792,
12782,12795,12802,12796,12790,12798,12797,12794,12784,12783,12847,12885,12907,12655,12810,12360,13155,13159,5633,13370,13423,13442,13443,13445,13447,13446,13453,7078,7076,7080,7082,7080,12808,7076,12803,13455,13452,13462,13454,13457,13456,13458,13461,13459,13460,13444,13503,13506,13510,13511,
13512,13513,13544,41192,41193,12846,41169,41171,41172,6887,13927,13928,13930,13929,13931,13932,13933,13934,13935,12368,16384,14339,14048,13856,13869,13868,14046,13858,13857,14042,13860,14143,13870,14043,14142,14100,14101,14141,13863,14044,14107,14103,14132,14134,13864,13871,14045,14136,14108,13865,
14104,14137,14144,14111,13866,14155,14128,14138,14139,13867,14130,14106,14140,14112,14146,14156,14154,14152,14153,14342,14529,14530,14645,14894,9319,15209,15448,15407,15077,15083,15045,15076,15084,15074,15047,15091,15564,15054,15046,15061,15067,15073,15078,15092,15071,15057,15064,15082,15086,15093,
15072,15069,15079,15053,15048,15060,15056,15065,15075,15094,15087,15063,15050,15066,15070,15080,15049,15058,15095,15088,15138,15051,15059,15062,15085,15081,15055,15090,15096,15068,15141,15052,15802,32768,32768,32768,15845,15843,15409,15846,15869,15870,15871,15872,15885,15992,15993,15994,15995,15996,
15999,16000,16004,10515,16005,15997,16023,16006,16009,16008,16022,16040,16007,38852,38853,38854,38855,38856,38857,38858,38859,38860,38861,9421,38862,5232,38863,38864,38865,38866,38867,38868,38869,38870,38871,38872,38873,38874,38875,16203,16202,16207,16206,16642,16643,16644,16766,2319,4234,4304,
16787,16892,16893,16895,16896,16973,16980,16979,16982,16983,16984,16989,16988,17014,17013,17015,17016,8364,4096,7867,1024,4096,128,17126,17197,17198,17182,17193,17222,17223,17074,2048,17324,17333,17325,17323,17353,17362,17363,17224,17364,17442,17505,17507,17506,17506,2048,48,17696,17704,
17708,38876,17202,17191,17716,17721,17723,17735,17758,2048,17781,4096,17690,17905,17906,17907,17908,17909,17691,17900,17901,17902,17903,17904,8051,16309,2756,2757,2758,2759,5462,8170,18045,18151,11320,18232,18238,18251,18253,38877,38878,18262,18263,18254,18283,18282,18168,18294,18258,18258,
7586,4096,18405,18407,18408,18409,18413,18486,18492,18504,18506,18508,18513,18509,18510,18511,11286,15875,8432,8095,18540,19016,17771,18583,18582,18584,32768,18609,18608,8192,18628,18640,9318,9312,9313,18588,18641,18631,18634,18587,18637,18594,18638,18639,18645,18642,18643,18598,18597,18660,
18662,18608,2048,18662,18713,20487,20488,18769,18770,18771,18799,2048,18775,18948,6265,18984,18986,19026,19004,19005,4228,19043,19048,19051,19057,19148,19164,19166,19167,19170,19168,19169,19213,19047,19050,19056,19059,19156,19165,19228,19257,19267,19277,19044,19049,19052,19058,19149,19157,19162,
19163,19422,19440,38879,38880,38881,38882,38883,38884,19450,19642,19574,19575,19576,19577,19696,19579,19585,19586,19588,19591,19592,19593,19594,19725,19598,19599,19600,19601,19602,19603,19604,19605,19610,19611,19612,19613,19606,19607,19608,19609,19614,19615,19616,19617,19618,19619,19620,19621,19682,
19683,19684,19685,19686,19687,19688,19689,19690,19691,19692,19693,19694,19695,13209,2048,19812,768,19880,19932,19931,19955,19953,19954,19959,19958,19952,19956,19951,19957,19974,19999,19998,20007,20002,20008,20004,19858,20039,20074,16416,16384,1024,1024,20256,20295,20296,20380,20393,20402,20402,
20452,20454,20455,20456,6265,20481,20480,20479,20476,20477,20478,20371,18715,18713,20416,20418,20419,20420,20432,20433,20435,20436,16384,20447,20448,20449,20450,20538,20539,20537,20549,20551,20550,20575,38885,38886,38887,38888,38889,38890,38891,38892,38893,38894,38895,16384,20744,20745,20746,20747,
20750,20749,20748,7068,20816,20817,20818,20821,20820,20823,20826,20827,20828,20831,20832,20833,20830,20907,20906,20909,20949,20950,20954,20955,20956,20963,20958,20966,20959,20960,20961,20967,21023,21072,21111,21109,21107,21106,21042,21136,21158,21161,21160,21174,21171,21171,21175,21206,21207,21208,
21209,21210,21201,21202,21203,21204,21205,21196,21197,21198,21199,21200,21217,21277,21340,21341,21342,128,128,32768,128,32768,2048,21519,21212,21536,21546,21278,21711,21154,21542,21558,21559,21557,21589,21590,21592,21571,21574,21576,21714,21716,21718,21569,21570,21975,21816,21818,21819,21821,
21823,21822,21820,21817,21840,21841,21842,21843,21844,21845,21846,21847,21848,21858,21869,21870,21871,21872,21873,21874,21875,21876,21849,21850,21851,21852,21853,21854,21855,21859,21860,21861,21862,21863,21864,21865,21866,21867,21868,21748,21756,20964,21758,21755,20969,21752,21760,21763,21764,21765,
21754,21753,21766,21769,21979,21767,21768,21785,21786,21774,21775,21790,21777,21778,21791,21784,21789,21792,21779,21793,21780,22260,21931,21932,21933,21934,22114,13583,21990,21991,2581,2581,2581,22018,768,768,768,768,22044,22048,6265,22116,22178,22160,22159,22163,22161,22162,40773,21980,
22155,22164,22154,22156,21981,21975,22165,22166,22158,22157,22167,22168,22169,22171,22170,22172,22048,22047,21984,22050,22049,22052,22051,22056,22197,22198,22196,22195,22194,22191,22246,22248,22249,22131,22132,22133,22262,22263,22136,22135,22134,22283,22284,22285,22287,22286,22288,22291,22289,22290,
22293,22292,22294,22296,22295,22297,22298,22299,22300,22251,22252,22048,22048,21946,22115,21986,21983,22385,22384,22383,38896,4096,38897,38898,38899,22475,22474,38900,38901,38902,38903,22484,38904,38905,38906,38907,38908,38909,37603,38910,38911,38912,38913,38914,38915,38916,38917,38918,38919,38920,
38921,38922,38923,38924,38925,38926,38927,22521,22522,22445,22449,22460,22459,22451,22452,21884,21885,22456,22457,21886,22628,41194,22654,22652,22658,22655,22660,22661,22662,22663,22664,22666,22665,22669,22670,22671,22645,22719,23194,23195,23196,22727,22728,22754,22762,22763,22764,22759,22760,22761,
22756,22757,22758,22822,22823,22824,22825,22826,22827,22828,22829,22830,22831,22871,22832,22833,22834,22835,22836,22837,22838,22839,21884,21885,22452,22451,22840,22841,22842,22844,22845,22846,22847,22848,22849,21885,22456,21884,22457,22452,21886,22850,22851,22853,22854,22861,22866,22895,23024,13909,
19822,19823,23094,23095,23096,23097,19824,19825,23098,23099,23100,23101,23103,23104,23105,19826,19827,19831,19829,23106,23108,19830,23109,19832,19833,23110,19834,23111,19835,23113,19836,19838,19839,19840,19841,23114,19842,19843,23115,23116,20034,23118,19845,19846,23119,20033,23120,19849,23121,19848,
19828,21407,21409,21408,21401,21403,21402,21413,21415,21414,21395,21397,21396,21410,21412,21411,21404,21406,21405,21398,21400,21399,21416,21418,21417,21392,21394,21393,23184,23182,23183,23211,23179,23180,23181,23227,23248,23355,6265,13582,23445,23446,23447,23448,23449,23442,23552,23482,23484,23487,
23488,23489,23493,23491,23494,23490,23497,23498,23499,23502,23503,23504,23505,23506,23508,23507,23510,23509,23511,23512,23515,23516,23514,23513,23517,23518,23519,23532,23524,23523,23525,23520,23521,23522,23526,23527,23528,23529,23530,23531,23533,23534,23535,23536,23537,23538,23539,23573,23571,23540,
23541,23542,23543,23544,23546,23554,23555,23556,23575,23576,23584,23585,23586,23614,23616,23670,23705,23709,23710,23712,23713,23714,23716,23720,23750,23726,23781,23782,23783,23784,23785,23786,23787,23736,23737,23742,23746,23747,23748,23758,23761,23762,23763,23764,23765,23766,23767,23768,23769,23770,
23771,23772,34504,23774,23775,23792,22575,22576,22577,23819,23821,23820,33092,33093,23840,23824,23826,23827,23831,23836,23838,23839,23841,23835,23825,23832,23828,23829,23859,23878,23879,23880,23895,24074,24075,24076,24077,24078,24079,24080,24082,24085,24086,24087,24088,24089,24092,24093,24095,24097,
24098,24106,24110,24114,24116,24117,24121,24122,24123,24124,24125,24126,24127,24128,24027,24028,24029,24030,24031,24032,24036,24033,24037,24039,24047,24048,24051,24050,24052,24053,24054,24055,24056,24057,24058,24059,24060,24061,24062,24066,24065,24067,24148,24149,23990,24035,24156,24184,24226,24271,
24273,24275,24274,24276,24249,24250,24251,24252,24253,24254,24255,24256,24257,23837,24258,24259,24260,24261,24262,24263,24264,24266,24267,24270,24268,24269,24287,24317,24520,24522,24573,24579,24581,24579,24579,24581,24581,24538,18662,25438,25439,25498,23559,25521,21887,23793,25650,25651,25652,25653,
25654,25655,25656,25657,25662,25661,25660,25659,25669,25670,25668,25671,25673,25674,25675,25676,25679,25680,25681,25683,25682,25685,25686,25687,25689,25690,25691,25695,25697,25696,25694,25692,25693,25752,25752,25752,25752,25843,25844,25845,22461,22462,22463,25840,25853,25867,25868,25880,25881,25882,
25883,25884,25886,25896,25897,25898,25899,25901,25890,25893,25894,25895,22446,22447,26045,26045,27445,27446,27317,27635,24105,27636,27651,27655,27656,27657,27658,27659,27660,27661,27662,27663,27664,27665,27666,27667,27808,22019,28100,28101,28102,28103,28104,24581,24579,28112,28132,28132,38928,38929,
38930,38931,38932,38933,38934,38935,38936,38937,38938,38939,38940,38941,38942,38943,38944,38945,38946,28290,22103,22104,22105,28048,28471,23563,23564,28483,28484,28425,28426,28428,28429,28431,28432,28434,28435,28437,28438,28440,28441,28595,28420,28421,28784,29051,29052,29157,29158,29159,29160,24289,
29201,29202,29203,29204,29207,28455,29483,29485,29486,29487,29488,29489,29490,29491,29493,29492,29540,29494,29495,29496,29497,29498,29499,29500,29532,29531,29528,29529,29530,29533,29535,29534,29536,29502,29503,29504,29505,29506,29507,29508,29512,29509,29510,29511,29514,29515,29516,29517,29519,29520,
29521,29522,29524,29523,29525,29526,29527,28455,22573,22574,29769,29778,29964,29970,29971,29973,29974,29975,30069,30070,30071,30072,30073,30074,30076,30077,30086,30087,30088,30089,30093,30155,23565,28485,28427,28430,28433,28436,28439,28442,30038,30036,30037,30035,30042,30040,30046,30044,30041,30039,
30045,30043,30309,30034,30032,30033,30031,30320,30419,30420,30421,30422,30438,30459,30460,30461,30465,30463,30464,24272,30499,30539,30542,30544,30616,30632,30639,30567,30658,30659,30703,30719,30721,30804,30816,30825,30831,30837,30838,30839,30847,31079,31080,31088,31122,31123,31108,31154,31130,31310,
30540,31346,31372,31364,31367,31368,31369,31370,31371,31398,31399,31518,31518,31530,22781,31607,31663,31672,31673,31679,31677,31676,31366,31704,24494,31763,31813,31084,31860,31861,31862,31864,31865,31863,31866,31869,31867,31868,31890,31891,31907,31914,31880,31881,32062,32063,32067,32068,29287,29290,
29279,29283,32193,32194,32195,32196,32197,32198,32199,32200,32201,32202,32203,32204,32205,32206,32207,32208,32209,32210,32211,32212,32213,32214,32215,32216,32217,32218,32219,32220,32221,32222,32223,32224,32225,32226,32320,32092,32364,7191,32408,32409,32410,32423,32413,32398,32400,32397,32394,32395,
32396,32393,32391,32392,32389,32390,32402,32403,32404,32401,32420,32449,32461,32498,32508,32578,32588,32566,32542,32594,32658,32665,32655,32659,32661,32656,32664,32662,32660,32663,31942,31942,31942,31942,32688,32689,32690,32691,32692,32693,32680,32657,32700,32701,32702,32703,32704,32705,32706,32707,
32708,32709,32710,32711,32712,32713,32598,32598,32601,32601,32734,32568,32570,32571,32573,32582,32583,32580,32581,32574,32575,32577,32579,32586,32587,32584,32585,32756,32472,32473,32474,32476,32475,32478,32479,32480,32494,32495,32572,32772,32774,32776,32833,32836,32840,32839,32846,32847,32844,32845,
32849,32850,32851,32852,29301,29297,29309,29305,32859,32860,32857,32858,32862,32861,32906,31279,32601,32601,32971,33041,33048,33051,33052,33053,32971,32971,33081,33081,33797,25535,33096,33105,33122,33133,33134,33131,33135,33143,33140,33144,22448,22448,38947,33173,33040,33185,33204,33208,33226,33218,
33226,32897,43518,43523,38948,33312,36799,33336,33341,33311,33340,33455,33477,33615,33616,33614,33617,33614,33618,33620,33781,33782,32643,33791,33797,33803,20475,33825,33839,33850,33848,33848,33866,33867,33872,33874,33924,33929,6265,32854,33993,33614,33614,34024,34062,34044,34056,34055,34060,34061,
34077,33306,34112,34099,34100,34105,33306,38949,34113,34123,34125,38950,38951,38953,38954,38955,38956,38959,37829,38960,38961,38962,38963,34135,38964,38965,38966,38967,38968,38969,44815,38972,38973,38974,22044,38975,38976,38977,38978,38979,38980,38981,38982,38984,38985,38987,38988,38989,38990,38991,
38992,38993,38995,38997,34092,34106,34207,34220,34087,34086,34085,34330,34411,34191,34440,34482,34490,34494,34494,34497,34497,34501,23773,34599,34599,34663,1180,34721,34722,39691,34748,34749,34750,34751,34752,34753,34754,34755,34756,34757,34758,34759,34760,34761,34762,34763,34764,34765,34766,34767,
42942,34769,34768,34832,34833,22449,35183,35185,35181,35182,35184,34847,34355,34356,34354,34357,34353,34362,34363,34361,34359,34360,34358,34366,34367,34364,34365,34372,34374,34370,34376,34371,34373,34369,34375,34380,34378,34379,34377,35126,35128,35276,35289,35315,35316,35318,38998,38999,35501,35503,
35563,35565,35568,35569,35581,35671,35692,35693,35694,35700,35702,35703,35707,35701,35734,35738,11445,35748,35749,35750,35751,39000,35759,35758,35760,35761,35784,35792,35908,35945,35806,35946,36748,36768,36772,36786,39001,36848,39002,6265,36895,41195,41196,39003,39004,39005,39006,37063,955,1181,
40924,37163,37163,37163,37163,37163,37164,37164,37164,37164,37168,37118,33929,37250,37303,37312,37459,37503,37501,41166,37570,37597,35623,36860,35622,35627,35625,35624,36916,36913,6836,37925,35797,38186,38225,36846,36828,36836,38266,36848,38324,38308,2290,4419,10308,27499,33458,37091,37092,1712,
4424,10306,27501,33460,37097,37098,1711,4422,10307,27502,33461,37093,37094,38277,38278,38333,38382,38380,38425,38408,38410,38411,38409,38407,38406,38400,38401,38402,38403,38404,38405,38414,38416,38424,38415,38413,38412,38420,38422,38417,38421,38419,38418,38375,38376,38371,38373,38372,38374,38374,
38378,38399,38347,38387,38388,38389,38390,38483,22044,4388,38590,38591,38592,38433,38437,38600,38626,38630,38631,38656,38653,38655,39213,39086,39087,39088,39085,39084,39083,39314,39314,39314,32399,37101,38682,39349,39469,36734,39576,39575,39520,39614,39656,39690,39737,39738,39748,39774,39710,39707,
39709,39711,39708,35627,36860,35622,35625,35622,35624,35624,35625,35623,35627,35623,36860,38699,40195,39996,39900,39905,39911,39906,33447,33448,39671,40067,39666,40068,40070,39907,39908,39909,40072,40076,23113,39912,39914,39915,39916,39918,39917,39934,39935,39942,39936,39941,39943,39945,39937,39944,
39938,39939,39933,39940,39947,39948,39949,39950,39951,39952,39953,39954,39955,39946,39956,39957,39958,39959,39960,39961,39962,39963,39964,39965,39966,39967,39968,40077,40078,40079,40081,46376,46379,46377,40087,40093,39974,39975,39976,39977,39978,39979,39980,39981,39982,39983,39984,39985,39986,39988,
39989,39990,39991,39992,39919,40213,40215,40217,40214,39920,39927,40216,39932,39997,39998,39999,40000,40001,40002,40003,40008,40009,40010,40011,40012,40013,40014,40015,40016,40017,40022,40023,40024,40025,40026,40027,40028,40029,40030,40031,40032,40033,40034,40037,40038,40039,40040,40043,40044,40045,
40046,40047,40048,40049,40050,40051,40052,40053,40054,40055,40056,40057,40058,40085,40086,40088,40089,40090,40091,40092,40095,40099,40102,40104,40094,40096,40100,40103,40105,40098,40101,40106,39910,40041,40248,40059,40110,46378,40073,40097,40211,40212,39688,36799,33312,22044,8008,8007,5513,5514,
40668,40669,40671,40672,40674,40673,40675,40670,40686,5396,31084,11000,13704,28395,24490,27808,32092,40942,40949,40950,40951,40952,40953,40943,40954,40955,20132,20131,25549,22999,24344,31404,40956,40957,40958,40959,31405,40643,28788,41117,41113,41114,41116,41126,41127,41128,41129,41132,41181,41182,
41183,41184,41185,41186,41187,41188,41189,41190,41238,41239,41240,41241,41242,41243,41245,37663,41163,41264,40769,41355,41356,41357,41344,41345,41346,41354,41351,41352,41348,41349,41347,41353,41350,38687,41257,41383,41384,41386,41387,41388,41391,41392,41394,41377,41375,41378,41379,41285,41307,41333,
41335,41339,41400,41401,41395,41396,41397,41398,41380,41381,41382,41385,41389,41376,41611,41741,41745,41974,41975,41976,41509,41510,41511,41548,41513,41515,44211,41520,41521,41522,41523,41525,41528,41543,41546,41551,41549,41545,41550,41544,41553,41554,41555,41248,41249,41251,41250,41252,41253,41254,
41255,41594,41593,41595,41597,41600,41598,41599,41601,41602,41603,41604,41607,41608,41609,41610,41984,41985,41986,42093,42095,42096,42100,42103,42101,42111,42102,42113,41519,41512,37705,37701,37702,37704,37703,37700,41544,42142,42143,42144,36766,42151,42152,42148,42153,42146,42158,42154,42150,42156,
42149,36767,42145,42155,42157,42342,42350,42381,42336,42337,42338,42339,42340,42341,42395,42413,42418,41367,42420,42421,17191,42423,42435,42433,42434,42432,42443,23529,39681,42500,42508,42545,40892,40771,40893,40772,40536,39682,41112,40767,40865,44951,41121,41146,39683,40768,40895,41164,41165,37567,
42546,41167,41168,42549,42550,42552,42553,42554,42555,42642,42643,42644,42645,42646,42647,42641,40109,42701,42702,42723,42727,42729,42730,42724,42726,42725,42728,42733,42551,37372,40896,40899,40914,40920,40908,40919,40915,40900,40923,40903,40909,40912,40913,40902,40901,40921,40916,40906,40897,40922,
40948,44922,40484,42734,42735,42736,42737,42738,42739,42741,42742,42743,42744,42745,42746,42747,42748,42749,42750,42751,42752,42753,42754,44920,44955,42897,42897,42897,42898,42899,42900,42901,42902,42903,42904,42905,42906,42907,42908,42909,42910,42911,42912,42913,42914,42915,42916,42917,42897,42897,
42897,42897,41101,41104,41107,41096,41099,41098,41103,41105,41095,41097,41106,41092,41108,41100,41094,41110,41109,41102,42897,42897,42897,42897,42897,42897,42897,42897,42954,42955,42956,42957,42958,42959,42960,42961,42962,42963,42964,42965,42966,42967,42968,42969,42970,42971,42972,42973,42974,42897,
42897,42897,42897,43420,43425,43412,43414,43415,43416,43417,43418,43419,43421,43422,43413,43423,43430,43424,43426,43427,43428,43429,43431,43432,42897,42897,42897,42897,42897,42897,42897,42897,42396,42397,42398,42399,42400,42401,42402,42403,42404,42405,42406,42407,42408,42409,42410,42411,42412,42414,
42415,42416,42417,42897,42897,42897,42897,43533,43534,43535,43536,43537,43538,43541,43542,43539,43543,43544,43545,43546,43547,43548,43549,43550,43551,43552,43553,43554,43673,43671,43672,42897,41517,41518,41524,41526,41527,41529,41530,41531,41532,41547,41533,41534,41535,41536,41537,41538,41539,41540,
41552,41541,41542,44923,42897,42897,42897,42453,42454,42455,42456,42457,42458,42459,42460,42461,42462,42463,42464,42465,42466,42467,42468,42469,42470,42471,42472,42473,42897,42897,42897,42897,42976,42976,42976,42976,42976,42976,42976,42976,34747,43015,41266,41334,42993,42994,43004,42995,42996,42997,
42998,43005,42999,43000,43001,43087,43099,43115,43116,43117,43118,43119,43120,43121,43122,43123,43124,43125,43126,43127,42740,43136,43144,43149,43215,43268,6265,43269,43270,43272,43274,43275,43276,43288,43298,43244,43245,43246,43247,43248,43249,43250,43251,43252,43253,43300,43348,43349,43316,43334,
43331,43332,43336,43337,40948,40484,43335,43355,43356,43338,43354,43350,43351,43339,43357,43359,43360,43364,43362,43361,43365,43366,43367,43340,43368,43369,43342,43371,43370,43373,43372,43374,43379,43376,43377,43343,43378,43380,43381,43385,43344,43386,43388,43383,43384,43389,43390,43392,43393,43391,
43394,43395,43396,43397,43398,43399,43400,3012,1477,4425,10309,27498,33457,43463,43464,954,2289,4426,10310,27503,33462,43465,43466,43482,43498,43490,43488,43491,43492,43478,43480,43515,43523,43570,43569,36892,36893,36894,43582,40068,40070,8529,43674,43725,43825,43826,43827,43850,43854,43853,
43860,43864,43865,43870,43871,43654,43655,44142,43656,43657,44161,39350,43660,43661,44163,43663,43664,43666,43667,38322,44210,37602,43145,43146,44316,44317,44318,43867,43868,43869,43969,43974,43973,43970,41516,43972,43975,43971,44497,44493,43987,44010,44063,33568,44148,44148,44148,44148,44148,44158,
44158,44158,44158,44158,43824,44221,44229,41173,41174,44259,44259,44259,44259,44259,44259,44259,44259,44326,44326,44326,44326,44326,44326,44326,44326,44276,44276,44276,44276,44276,44276,44276,44276,44294,44294,44294,44294,44294,44294,44294,44294,44304,44314,44315,41163,44325,44327,44328,44329,19228,
19228,19228,19228,19228,19228,19228,44330,44331,44332,19267,19267,19267,19267,19267,19267,19267,19277,19277,19277,19277,19277,19277,19277,19257,19257,19257,19257,19257,19257,19257,31890,31890,31890,31890,31890,31890,31890,44322,31907,31907,31907,31907,31907,31907,44323,31907,44324,31914,31914,31914,
31914,31914,31914,31914,31891,31891,31891,31891,31891,31891,31891,44434,38436,38440,44436,44437,44438,44449,38434,38438,44456,44440,44441,38971,44451,44452,44442,44453,38435,38986,38439,44443,44444,44445,38441,43566,43565,44446,44447,44448,43129,44430,43130,43131,44455,43132,43133,42731,44457,43255,
43256,44458,43257,43258,44462,44462,44462,44463,44465,43260,43433,43434,43435,43436,43437,44466,43438,43439,44467,43261,43262,43263,43264,43265,43266,43271,43273,43447,43449,43445,43444,43446,43442,43448,43443,43455,43457,43453,43452,43454,43450,43456,43451,43458,43459,43461,43469,43481,43484,43495,
43502,44469,44470,44480,44480,44480,44480,41508,44413,44504,41165,41164,44554,44558,44555,44557,44556,43584,43583,43585,43590,43591,43592,43593,43594,43595,43586,43587,43588,44607,44608,44609,44617,44616,44618,44619,44724,44738,44739,44740,44741,44742,44684,34052,44836,44838,44834,44840,44837,44839,
44928,44930,44931,44936,44939,44943,44947,44946,44949,44953,44958,8827,44963,39286,44981,45127,35279,35280,45127,45127,45039,45045,45054,45056,45060,45127,45127,45082,45085,45550,45559,45552,45561,45551,45560,45553,45562,45554,45563,45555,45564,45556,45565,45557,45566,45558,45567,45176,45500,45621,
45626,45627,45628,45631,46069,46069,46069,46069,46069,46070,46070,46070,46070,46070,45773,46069,45854,45849,33004,45735,45778,45785,45734,45789,45747,45797,45733,45746,45793,45623,45740,45622,45760,45768,45775,45776,45804,45805,45601,45602,45625,45731,45736,45737,45738,45741,45742,45743,45753,45755,
45756,45758,45761,45762,45764,45770,45771,45772,45779,45781,45790,45792,45799,45800,45803,45806,45908,45795,45769,45732,45745,45604,45744,45757,45767,45783,45794,45603,45739,45766,45777,45782,45780,45942,45932,46026,46098,33568,46106,45812,45813,45808,45809,45811,45810,46319,46372,46377,46376,46378,
46379,46397,46396,46691,46783,44839,44840,44836,44838,44837,46847,41165,40167,40168,40166,40175,40165,40164,40170,40169,40171,40176,40172,40181,40177,40174,40180,40179,40182,40178,40173,40113,40111,40112,40114,40118,40117,40115,40116,46887,40119,40120,40122,40121,40125,40124,40123,40126,40127,40128,
33447,40136,40129,40132,40133,40130,40134,40138,40139,40141,40135,40140,40137,40131,40151,40142,40147,40152,40153,40154,40143,40157,40155,40148,40162,40156,40161,40144,40158,40160,40145,40146,40150,40149,40163,40159,46735,36931,36919,36922,36928,36925,36934,47030,47036,46978,46955,47499,47605,47587,
47603,47585,47597,47579,47595,47576,47602,47583,47599,47581,47591,47570,47589,47572,47593,47574,47592,47571,47590,47573,47594,47575,47598,47580,47596,47582,47601,47584,47600,47577,47606,47586,47604,47588,42482,47828,46725,48720,48933,48945,48933,49040,49084,49110,49301,43489,49632,49633,49634,49497,
49655,49916,49698,49703,49704,49739,49750,49768,12655,49891,49890,49892,49893,49898,49894,49899,49895,49900,49896,49901,49897,49902,49905,49903,49906,49904,49907,49915,49661,49668,49669,49670,50125,37706,50045,50077,50816,52020,52021,49888,52566,52729,53510,54467,54797,
}

-- Static tables of ItemRandomPropeties.dbc and ItemRandomSuffix.dbc to assign enchant IDs to random property items
-- There's currently no convenient way for Eluna to get this information the core as it's set by dbc files. For servers that don't have the dbc files database-loaded, we need to have a cached table for reference. 
-- We don't really need InternalName here but it's useful to debug why a random suffix may have the wrong stats for the item in question.
local ItemRandomSuffix = { -- 48 is a paladin test ID, and 94-98 are related to Darkmoon Faire, removed.
    [5] = {InternalName = "Monkey", Enchantment = {2802, 2803, 0, 0, 0}}, 			 [6] = {InternalName = "Eagle", Enchantment = {2804, 2803, 0, 0, 0}},
    [7] = {InternalName = "Bear", Enchantment = {2803, 2805, 0, 0, 0}},				 [8] = {InternalName = "Whale", Enchantment = {2806, 2803, 0, 0, 0}},
    [9] = {InternalName = "Owl", Enchantment = {2804, 2806, 0, 0, 0}}, 				 [10] = {InternalName = "Gorilla", Enchantment = {2804, 2805, 0, 0, 0}},
    [11] = {InternalName = "Falcon", Enchantment = {2802, 2804, 0, 0, 0}}, 			 [12] = {InternalName = "Boar", Enchantment = {2806, 2805, 0, 0, 0}},
    [13] = {InternalName = "Wolf", Enchantment = {2802, 2806, 0, 0, 0}}, 			 [14] = {InternalName = "Tiger", Enchantment = {2802, 2805, 0, 0, 0}},
    [15] = {InternalName = "Spirit", Enchantment = {2806, 0, 0, 0, 0}}, 			 [16] = {InternalName = "Stamina", Enchantment = {2803, 0, 0, 0, 0}},
    [17] = {InternalName = "Strength", Enchantment = {2805, 0, 0, 0, 0}}, 			 [18] = {InternalName = "Agility", Enchantment = {2802, 0, 0, 0, 0}},
    [19] = {InternalName = "Intellect", Enchantment = {2804, 0, 0, 0, 0}}, 			 [20] = {InternalName = "Power", Enchantment = {2825, 0, 0, 0, 0}},
    [21] = {InternalName = "Arcane Wrath (SP)", Enchantment = {2824, 0, 0, 0, 0}},	 [22] = {InternalName = "Fiery Wrath (SP)", Enchantment = {2824, 0, 0, 0, 0}},
    [23] = {InternalName = "Frozen Wrath (SP)", Enchantment = {2824, 0, 0, 0, 0}}, 	 [24] = {InternalName = "Nature's Wrath (SP)", Enchantment = {2824, 0, 0, 0, 0}},
    [25] = {InternalName = "Shadow Wrath (SP)", Enchantment = {2824, 0, 0, 0, 0}}, 	 [26] = {InternalName = "Spell Power", Enchantment = {2824, 0, 0, 0, 0}},
	[27] = {InternalName = "Defense", Enchantment = {2813, 0, 0, 0, 0}}, 			 [28] = {InternalName = "Regeneration", Enchantment = {2814, 0, 0, 0, 0}},
	[29] = {InternalName = "Eluding", Enchantment = {2815, 2802, 0, 0, 0}},			 [30] = {InternalName = "Concentration", Enchantment = {2816, 0, 0, 0, 0}},
	[31] = {InternalName = "Arcane Protection", Enchantment = {2803, 2817, 0, 0, 0}},[32] = {InternalName = "Fire Protection", Enchantment = {2803, 2818, 0, 0, 0}},
	[33] = {InternalName = "Frost Protection", Enchantment = {2803, 2819, 0, 0, 0}}, [34] = {InternalName = "Nature Protection", Enchantment = {2803, 2820, 0, 0, 0}},
	[35] = {InternalName = "Shadow Protection", Enchantment = {2803, 2821, 0, 0, 0}},[36] = {InternalName = "Sorcerer", Enchantment = {2803, 2804, 2824, 0, 0}},
	[37] = {InternalName = "Physician", Enchantment = {2803, 2804, 2824, 0, 0}},     [38] = {InternalName = "Prophet", Enchantment = {2804, 2806, 2824, 0, 0}},
	[39] = {InternalName = "Invoker", Enchantment = {2804, 2824, 2822, 0, 0}}, 	     [40] = {InternalName = "Bandit", Enchantment = {2802, 2803, 2825, 0, 0}},
	[41] = {InternalName = "Beast", Enchantment = {2805, 2802, 2803, 0, 0}},     	 [42] = {InternalName = "Hierophant", Enchantment = {2803, 2806, 2824, 0, 0}},
    [43] = {InternalName = "Soldier", Enchantment = {2805, 2803, 2823, 0, 0}},       [44] = {InternalName = "Elder", Enchantment = {2803, 2804, 2816, 0, 0}},
    [45] = {InternalName = "Champion", Enchantment = {2805, 2803, 2813, 0, 0}},      [46] = {InternalName = "Test", Enchantment = {2798, 2799, 2800, 2802, 2806}},
    [47] = {InternalName = "Blocking", Enchantment = {2826, 2805, 0, 0, 0}},    	 --[[48 is a test suffix, skipping]]
	[49] = {InternalName = "Grove", Enchantment = {2805, 2802, 2803, 0, 0}},		 [50] = {InternalName = "Hunt", Enchantment = {2825, 2802, 2804, 0, 0}},    		 
    [51] = {InternalName = "Mind", Enchantment = {2824, 2822, 2804, 0, 0}},			 [52] = {InternalName = "Crusade", Enchantment = {2824, 2804, 2813, 0, 0}},
	[53] = {InternalName = "Vision", Enchantment = {2824, 2804, 2803, 0, 0}},		 [54] = {InternalName = "Ancestor", Enchantment = {2805, 2823, 2803, 0, 0}},
	[55] = {InternalName = "Nightmare", Enchantment = {2811, 2803, 2804, 0, 0}},     [56] = {InternalName = "Battle", Enchantment = {2805, 2803, 2823, 0, 0}},
	[57] = {InternalName = "Shadow", Enchantment = {2825, 2802, 2803, 0, 0}},        [58] = {InternalName = "Sun", Enchantment = {2824, 2803, 2804, 0, 0}},
	[59] = {InternalName = "Moon", Enchantment = {2804, 2803, 2806, 0, 0}},		     [60] = {InternalName = "Wild", Enchantment = {2825, 2803, 2802, 0, 0}},
	[61] = {InternalName = "Spell Power (Resist)", Enchantment = {2824, 0, 0, 0, 0}},[62] = {InternalName = "Strength resistance", Enchantment = {2805, 0, 0, 0, 0}},
	[63] = {InternalName = "Agility (resistance)", Enchantment = {2802, 0, 0, 0, 0}},[64] = {InternalName = "Power (resistance)", Enchantment = {2825, 0, 0, 0, 0}},
	[65] = {InternalName = "Magic (resistance)", Enchantment = {2824, 0, 0, 0, 0}},  [66] = {InternalName = "Knight", Enchantment = {2803, 2813, 2824, 0, 0}},
	[67] = {InternalName = "Seer", Enchantment = {2803, 2822, 2824, 0, 0}},		     [68] = {InternalName = "Bear (<60)", Enchantment = {2805, 2803, 0, 0, 0}},
	[69] = {InternalName = "Eagle (<60)", Enchantment = {2803, 2804, 0, 0, 0}},      [70] = {InternalName = "Ancestor (<60)", Enchantment = {2805, 2822, 2803, 0, 0}},
	[71] = {InternalName = "Bandit (<60)", Enchantment = {2802, 2803, 2825, 0, 0}},  [72] = {InternalName = "Battle (<60)", Enchantment = {2805, 2803, 2822, 0, 0}},
	[73] = {InternalName = "Elder (<60)", Enchantment = {2803, 2804, 2816, 0, 0}},   [74] = {InternalName = "Beast (<60)", Enchantment = {2805, 2802, 2803, 0, 0}},
	[75] = {InternalName = "Champion (<60)", Enchantment = {2805, 2803, 2813, 0, 0}}, --[[76 doesn't exist]]
	--[[77-79 don't exist]]															 [80] = {InternalName = "Wild (<60)", Enchantment = {2825, 2803, 2802, 0, 0}},
	[81] = {InternalName = "Whale (<60)", Enchantment = {2803, 2806, 0, 0, 0}},	     [82] = {InternalName = "Vision (<60)", Enchantment = {2824, 2804, 2803, 0, 0}},
	[83] = {InternalName = "Sun (<60)", Enchantment = {2824, 2803, 2804, 0, 0}},     [84] = {InternalName = "Stamina (<60)", Enchantment = {2803, 0, 0, 0, 0}},
	[85] = {InternalName = "Sorcerer (<60)", Enchantment = {2803, 2804, 2824, 0, 0}},[86] = {InternalName = "Soldier (<60)", Enchantment = {2805, 2803, 2822, 0, 0}},
	[87] = {InternalName = "Shadow (<60)", Enchantment = {2825, 2802, 2803, 0, 0}},  [88] = {InternalName = "Foreseer", Enchantment = {2804, 3726, 2824, 0, 0}},
	[89] = {InternalName = "Thief", Enchantment = {2803, 2825, 3726, 0, 0}},	     [90] = {InternalName = "Necromancer", Enchantment = {2803, 3727, 2824, 0, 0}},
	[91] = {InternalName = "Marksman", Enchantment = {2803, 2802, 3727, 0, 0}},	     [92] = {InternalName = "Squire", Enchantment = {2803, 3727, 2805, 0, 0}},
	[93] = {InternalName = "Restoration", Enchantment = {2803, 2824, 2816, 0, 0}},   [99] = {InternalName = "Haste", Enchantment = {3726, 0, 0, 0, 0}}
}

local ItemRandomProperties = {
	[5] = {79, 0, 0}, [6] = {68, 0, 0}, [14] = {74, 0, 0}, [15] = {71, 0, 0}, [16] = {82, 0, 0}, [17] = {75, 0, 0},
    [18] = {76, 0, 0}, [19] = {72, 0, 0}, [22] = {73, 0, 0}, [23] = {69, 0, 0}, [24] = {70, 0, 0}, [25] = {80, 0, 0},
    [26] = {81, 0, 0}, [27] = {83, 0, 0}, [28] = {84, 0, 0}, [29] = {85, 0, 0}, [30] = {87, 0, 0}, [31] = {86, 0, 0},
    [32] = {67, 0, 0}, [33] = {77, 0, 0}, [34] = {78, 0, 0}, [39] = {153, 0, 0}, [40] = {139, 0, 0}, [41] = {125, 0, 0},
    [42] = {160, 0, 0}, [43] = {146, 0, 0}, [44] = {132, 0, 0}, [45] = {181, 0, 0}, [46] = {167, 0, 0}, [47] = {174, 0, 0},
    [48] = {110, 0, 0}, [49] = {188, 0, 0}, [50] = {199, 0, 0}, [51] = {195, 0, 0}, [52] = {154, 0, 0}, [53] = {140, 0, 0},
    [54] = {126, 0, 0}, [56] = {161, 0, 0}, [57] = {147, 0, 0}, [58] = {133, 0, 0}, [59] = {182, 0, 0}, [60] = {168, 0, 0},
    [62] = {111, 0, 0}, [63] = {175, 0, 0}, [64] = {189, 0, 0}, [65] = {200, 0, 0}, [66] = {155, 0, 0}, [67] = {141, 0, 0},
    [68] = {127, 0, 0}, [69] = {162, 0, 0}, [70] = {148, 0, 0}, [71] = {134, 0, 0}, [72] = {183, 0, 0}, [73] = {169, 0, 0},
    [74] = {112, 0, 0}, [75] = {176, 0, 0}, [76] = {190, 0, 0}, [77] = {201, 0, 0}, [78] = {196, 0, 0}, [79] = {89, 0, 0},
    [80] = {117, 0, 0}, [81] = {156, 0, 0}, [82] = {142, 0, 0}, [83] = {128, 0, 0}, [84] = {163, 0, 0}, [85] = {149, 0, 0},
    [86] = {135, 0, 0}, [87] = {184, 0, 0}, [88] = {170, 0, 0}, [89] = {113, 0, 0}, [90] = {177, 0, 0}, [91] = {191, 0, 0},
    [92] = {202, 0, 0}, [93] = {90, 0, 0}, [94] = {94, 0, 0}, [95] = {98, 0, 0}, [96] = {102, 0, 0}, [97] = {106, 0, 0},
    [98] = {121, 0, 0}, [99] = {118, 0, 0}, [100] = {157, 0, 0}, [101] = {143, 0, 0}, [102] = {129, 0, 0}, [103] = {164, 0, 0},
    [104] = {150, 0, 0}, [105] = {136, 0, 0}, [106] = {185, 0, 0}, [107] = {171, 0, 0}, [108] = {114, 0, 0}, [109] = {178, 0, 0},
    [110] = {192, 0, 0}, [111] = {91, 0, 0}, [112] = {95, 0, 0}, [113] = {99, 0, 0}, [114] = {103, 0, 0}, [115] = {107, 0, 0},
    [116] = {197, 0, 0}, [117] = {200, 188, 110}, [118] = {122, 0, 0}, [119] = {119, 0, 0}, [120] = {158, 0, 0}, [121] = {144, 0, 0},
    [122] = {130, 0, 0}, [123] = {165, 0, 0}, [124] = {151, 0, 0}, [125] = {137, 0, 0}, [126] = {186, 0, 0}, [127] = {172, 0, 0},
    [128] = {115, 0, 0}, [129] = {179, 0, 0}, [130] = {193, 0, 0}, [131] = {204, 0, 0}, [132] = {92, 0, 0}, [133] = {96, 0, 0},
    [134] = {100, 0, 0}, [135] = {104, 0, 0}, [136] = {108, 0, 0}, [137] = {123, 0, 0}, [138] = {120, 0, 0}, [139] = {159, 0, 0},
    [140] = {145, 0, 0}, [141] = {131, 0, 0}, [142] = {166, 0, 0}, [143] = {152, 0, 0}, [144] = {138, 0, 0}, [145] = {187, 0, 0},
    [146] = {173, 0, 0}, [147] = {116, 0, 0}, [148] = {180, 0, 0}, [149] = {194, 0, 0}, [150] = {205, 0, 0}, [151] = {93, 0, 0},
    [152] = {97, 0, 0}, [153] = {101, 0, 0}, [154] = {105, 0, 0}, [155] = {109, 0, 0}, [156] = {198, 0, 0}, [167] = {343, 0, 0},
    [168] = {349, 0, 0}, [171] = {358, 0, 0}, [172] = {363, 0, 0}, [173] = {368, 0, 0}, [174] = {350, 0, 0}, [175] = {354, 0, 0},
    [176] = {359, 0, 0}, [177] = {364, 0, 0}, [178] = {369, 0, 0}, [179] = {351, 0, 0}, [180] = {355, 0, 0}, [181] = {360, 0, 0},
    [182] = {365, 0, 0}, [183] = {370, 0, 0}, [184] = {353, 0, 0}, [185] = {356, 0, 0}, [186] = {361, 0, 0}, [187] = {366, 0, 0},
    [188] = {371, 0, 0}, [189] = {352, 0, 0}, [190] = {357, 0, 0}, [191] = {362, 0, 0}, [192] = {367, 0, 0}, [193] = {372, 0, 0},
    [194] = {344, 0, 0}, [195] = {346, 0, 0}, [196] = {345, 0, 0}, [197] = {347, 0, 0}, [198] = {348, 0, 0}, [207] = {383, 0, 0},
    [210] = {384, 0, 0}, [211] = {403, 0, 0}, [212] = {404, 0, 0}, [213] = {405, 0, 0}, [214] = {406, 0, 0}, [215] = {407, 0, 0},
    [216] = {408, 0, 0}, [217] = {409, 0, 0}, [218] = {411, 0, 0}, [219] = {410, 0, 0}, [220] = {412, 0, 0}, [227] = {74, 79, 0},
    [228] = {74, 82, 0}, [229] = {75, 79, 0}, [231] = {74, 80, 0}, [232] = {75, 81, 0}, [233] = {76, 80, 0}, [234] = {76, 81, 0},
    [235] = {90, 81, 0}, [236] = {76, 94, 0}, [237] = {90, 95, 0}, [238] = {75, 80, 0}, [247] = {91, 95, 0}, [248] = {90, 94, 0},
    [249] = {91, 94, 0}, [250] = {91, 96, 0}, [251] = {92, 96, 0}, [252] = {92, 95, 0}, [253] = {92, 97, 0}, [254] = {93, 97, 0},
    [255] = {93, 96, 0}, [256] = {74, 83, 0}, [267] = {883, 0, 0}, [287] = {1068, 0, 0}, [307] = {684, 0, 0}, [308] = {1043, 0, 0},
    [309] = {1044, 0, 0}, [310] = {1045, 0, 0}, [311] = {1046, 0, 0}, [312] = {1047, 0, 0}, [313] = {1048, 0, 0}, [314] = {1049, 0, 0},
    [315] = {1050, 0, 0}, [316] = {1051, 0, 0}, [317] = {1052, 0, 0}, [318] = {1053, 0, 0}, [319] = {1054, 0, 0}, [320] = {1055, 0, 0},
    [321] = {1056, 0, 0}, [322] = {1057, 0, 0}, [323] = {1058, 0, 0}, [324] = {1059, 0, 0}, [325] = {1060, 0, 0}, [326] = {1061, 0, 0},
    [327] = {1062, 0, 0}, [328] = {1063, 0, 0}, [329] = {1064, 0, 0}, [330] = {1065, 0, 0}, [331] = {1066, 0, 0}, [332] = {1067, 0, 0},
    [333] = {1069, 0, 0}, [334] = {1070, 0, 0}, [335] = {1071, 0, 0}, [336] = {1072, 0, 0}, [337] = {1073, 0, 0}, [338] = {1074, 0, 0},
    [339] = {1075, 0, 0}, [340] = {1076, 0, 0}, [341] = {1077, 0, 0}, [342] = {1078, 0, 0}, [343] = {1079, 0, 0}, [344] = {1080, 0, 0},
    [345] = {1081, 0, 0}, [346] = {1082, 0, 0}, [347] = {1083, 0, 0}, [348] = {1084, 0, 0}, [349] = {1085, 0, 0}, [350] = {1086, 0, 0},
    [351] = {1087, 0, 0}, [352] = {1088, 0, 0}, [353] = {1089, 0, 0}, [354] = {1090, 0, 0}, [355] = {1091, 0, 0}, [356] = {1092, 0, 0},
    [357] = {1093, 0, 0}, [358] = {983, 0, 0}, [359] = {1094, 0, 0}, [360] = {1095, 0, 0}, [361] = {1096, 0, 0}, [362] = {1097, 0, 0},
    [363] = {1098, 0, 0}, [364] = {1099, 0, 0}, [365] = {1100, 0, 0}, [366] = {1101, 0, 0}, [367] = {1102, 0, 0}, [368] = {1103, 0, 0},
    [369] = {1104, 0, 0}, [370] = {1105, 0, 0}, [371] = {1106, 0, 0}, [372] = {1107, 0, 0}, [373] = {1108, 0, 0}, [374] = {1109, 0, 0},
    [375] = {1110, 0, 0}, [376] = {1111, 0, 0}, [377] = {1112, 0, 0}, [378] = {1113, 0, 0}, [379] = {1114, 0, 0}, [380] = {1115, 0, 0},
    [381] = {1116, 0, 0}, [382] = {1117, 0, 0}, [383] = {1118, 0, 0}, [384] = {1119, 0, 0}, [385] = {1120, 0, 0}, [386] = {1121, 0, 0},
    [387] = {1122, 0, 0}, [388] = {1123, 0, 0}, [389] = {1124, 0, 0}, [390] = {1125, 0, 0}, [391] = {1126, 0, 0}, [392] = {1127, 0, 0},
    [393] = {1128, 0, 0}, [394] = {1129, 0, 0}, [395] = {1130, 0, 0}, [396] = {1131, 0, 0}, [397] = {1132, 0, 0}, [398] = {1133, 0, 0},
    [399] = {1134, 0, 0}, [400] = {1135, 0, 0}, [401] = {1136, 0, 0}, [402] = {1137, 0, 0}, [403] = {1138, 0, 0}, [404] = {1139, 0, 0},
    [405] = {1140, 0, 0}, [406] = {1141, 0, 0}, [407] = {1142, 0, 0}, [408] = {1143, 0, 0}, [409] = {1144, 0, 0}, [410] = {1145, 0, 0},
    [411] = {1146, 0, 0}, [412] = {1147, 0, 0}, [413] = {1148, 0, 0}, [414] = {1149, 0, 0}, [415] = {1150, 0, 0}, [416] = {1151, 0, 0},
    [417] = {1152, 0, 0}, [418] = {1153, 0, 0}, [419] = {1154, 0, 0}, [420] = {1155, 0, 0}, [421] = {1156, 0, 0}, [422] = {1157, 0, 0},
    [423] = {1158, 0, 0}, [424] = {1159, 0, 0}, [425] = {1160, 0, 0}, [426] = {1161, 0, 0}, [427] = {1162, 0, 0}, [428] = {1163, 0, 0},
    [429] = {1164, 0, 0}, [430] = {1165, 0, 0}, [431] = {1166, 0, 0}, [432] = {1167, 0, 0}, [433] = {1168, 0, 0}, [434] = {1183, 0, 0},
    [435] = {343, 97, 0}, [436] = {93, 350, 0}, [437] = {343, 350, 0}, [438] = {349, 350, 0}, [439] = {343, 354, 0}, [440] = {349, 354, 0},
    [441] = {358, 354, 0}, [442] = {349, 359, 0}, [443] = {358, 359, 0}, [444] = {363, 359, 0}, [445] = {358, 364, 0}, [446] = {363, 364, 0},
    [447] = {368, 364, 0}, [448] = {363, 369, 0}, [449] = {368, 369, 0}, [450] = {403, 369, 0}, [451] = {368, 405, 0}, [452] = {403, 405, 0},
    [453] = {404, 405, 0}, [454] = {403, 406, 0}, [455] = {404, 406, 0}, [456] = {883, 406, 0}, [457] = {404, 1118, 0}, [458] = {883, 1118, 0},
    [459] = {983, 1118, 0}, [460] = {883, 1119, 0}, [461] = {983, 1119, 0}, [462] = {1094, 1119, 0}, [463] = {983, 1120, 0}, [464] = {1094, 1120, 0},
    [465] = {1095, 1120, 0}, [466] = {1094, 1121, 0}, [467] = {1095, 1121, 0}, [468] = {1096, 1121, 0}, [469] = {1095, 1122, 0}, [470] = {1096, 1122, 0},
    [471] = {1097, 1122, 0}, [472] = {1096, 1123, 0}, [473] = {1097, 1123, 0}, [474] = {1098, 1123, 0}, [475] = {1097, 1124, 0}, [476] = {1098, 1124, 0},
    [477] = {1099, 1124, 0}, [478] = {1098, 1125, 0}, [479] = {1099, 1125, 0}, [480] = {1100, 1125, 0}, [481] = {1099, 1126, 0}, [482] = {1100, 1126, 0},
    [483] = {1101, 1126, 0}, [484] = {1100, 1127, 0}, [485] = {1101, 1127, 0}, [486] = {1102, 1127, 0}, [487] = {1101, 1128, 0}, [488] = {1102, 1128, 0},
    [489] = {1103, 1128, 0}, [490] = {1102, 1129, 0}, [491] = {1103, 1129, 0}, [492] = {1104, 1129, 0}, [493] = {1103, 1130, 0}, [494] = {1104, 1130, 0},
    [495] = {1105, 1130, 0}, [496] = {1104, 1131, 0}, [497] = {1105, 1131, 0}, [498] = {1106, 1131, 0}, [499] = {1105, 1132, 0}, [500] = {1106, 1132, 0},
    [501] = {75, 82, 0}, [502] = {75, 83, 0}, [503] = {76, 83, 0}, [504] = {75, 84, 0}, [505] = {76, 84, 0}, [506] = {90, 84, 0},
    [507] = {76, 98, 0}, [508] = {90, 98, 0}, [509] = {91, 98, 0}, [510] = {90, 99, 0}, [511] = {91, 99, 0}, [512] = {92, 99, 0},
    [513] = {91, 100, 0}, [514] = {92, 100, 0}, [515] = {93, 100, 0}, [516] = {92, 101, 0}, [517] = {93, 101, 0}, [518] = {343, 101, 0},
    [519] = {93, 351, 0}, [520] = {343, 351, 0}, [521] = {349, 351, 0}, [522] = {343, 355, 0}, [523] = {349, 355, 0}, [524] = {358, 355, 0},
    [525] = {349, 360, 0}, [526] = {358, 360, 0}, [527] = {363, 360, 0}, [528] = {358, 365, 0}, [529] = {363, 365, 0}, [530] = {368, 365, 0},
    [531] = {363, 370, 0}, [532] = {368, 370, 0}, [533] = {403, 370, 0}, [534] = {368, 407, 0}, [535] = {403, 407, 0}, [536] = {404, 407, 0},
    [537] = {403, 408, 0}, [538] = {404, 408, 0}, [539] = {883, 408, 0}, [540] = {404, 1144, 0}, [541] = {883, 1144, 0}, [542] = {983, 1144, 0},
    [543] = {883, 1145, 0}, [544] = {983, 1145, 0}, [545] = {1094, 1145, 0}, [546] = {983, 1146, 0}, [547] = {1094, 1146, 0}, [548] = {1095, 1146, 0},
    [549] = {1094, 1147, 0}, [550] = {1095, 1147, 0}, [551] = {1096, 1147, 0}, [552] = {1095, 1148, 0}, [553] = {1096, 1148, 0}, [554] = {1097, 1148, 0},
    [555] = {1096, 1149, 0}, [556] = {1097, 1149, 0}, [557] = {1098, 1149, 0}, [558] = {1097, 1150, 0}, [559] = {1098, 1150, 0}, [560] = {1099, 1150, 0},
    [561] = {1098, 1151, 0}, [562] = {1099, 1151, 0}, [563] = {1100, 1151, 0}, [564] = {1099, 1152, 0}, [565] = {1100, 1152, 0}, [566] = {1101, 1152, 0},
    [567] = {1100, 1153, 0}, [568] = {1101, 1153, 0}, [569] = {1102, 1153, 0}, [570] = {1101, 1154, 0}, [571] = {1102, 1154, 0}, [572] = {1103, 1154, 0},
    [573] = {1102, 1155, 0}, [574] = {1103, 1155, 0}, [575] = {1104, 1155, 0}, [576] = {1103, 1156, 0}, [577] = {1104, 1156, 0}, [578] = {1105, 1156, 0},
    [579] = {1104, 1157, 0}, [580] = {1105, 1157, 0}, [581] = {1106, 1157, 0}, [582] = {1105, 1158, 0}, [583] = {1106, 1158, 0}, [584] = {74, 71, 0},
    [585] = {75, 71, 0}, [586] = {74, 72, 0}, [587] = {75, 72, 0}, [588] = {76, 72, 0}, [589] = {75, 73, 0}, [590] = {76, 73, 0},
    [591] = {90, 73, 0}, [592] = {76, 102, 0}, [593] = {90, 102, 0}, [594] = {91, 102, 0}, [595] = {90, 103, 0}, [596] = {91, 103, 0},
    [597] = {92, 103, 0}, [598] = {91, 104, 0}, [599] = {92, 104, 0}, [600] = {93, 104, 0}, [601] = {92, 105, 0}, [602] = {93, 105, 0},
    [603] = {343, 105, 0}, [604] = {93, 353, 0}, [605] = {343, 353, 0}, [606] = {349, 353, 0}, [607] = {343, 356, 0}, [608] = {349, 356, 0},
    [609] = {358, 356, 0}, [610] = {349, 361, 0}, [611] = {358, 361, 0}, [612] = {363, 361, 0}, [613] = {358, 366, 0}, [614] = {363, 366, 0},
    [615] = {368, 366, 0}, [616] = {363, 371, 0}, [617] = {368, 371, 0}, [618] = {403, 371, 0}, [619] = {368, 409, 0}, [620] = {403, 409, 0},
    [621] = {404, 409, 0}, [622] = {403, 411, 0}, [623] = {404, 411, 0}, [624] = {883, 411, 0}, [625] = {404, 1068, 0}, [626] = {883, 1068, 0},
    [627] = {983, 1068, 0}, [628] = {883, 1069, 0}, [629] = {983, 1069, 0}, [630] = {1094, 1069, 0}, [631] = {983, 1070, 0}, [632] = {1094, 1070, 0},
    [633] = {1095, 1070, 0}, [634] = {1094, 1071, 0}, [635] = {1095, 1071, 0}, [636] = {1096, 1071, 0}, [637] = {1095, 1072, 0}, [638] = {1096, 1072, 0},
    [639] = {1097, 1072, 0}, [640] = {1096, 1073, 0}, [641] = {1097, 1073, 0}, [642] = {1098, 1073, 0}, [643] = {1097, 1074, 0}, [644] = {1098, 1074, 0},
    [645] = {1099, 1074, 0}, [646] = {1098, 1075, 0}, [647] = {1099, 1075, 0}, [648] = {1100, 1075, 0}, [649] = {1099, 1076, 0}, [650] = {1100, 1076, 0},
    [651] = {1101, 1076, 0}, [652] = {1100, 1077, 0}, [653] = {1101, 1077, 0}, [654] = {1102, 1077, 0}, [655] = {1101, 1078, 0}, [656] = {1102, 1078, 0},
    [657] = {1103, 1078, 0}, [658] = {1102, 1079, 0}, [659] = {1103, 1079, 0}, [660] = {1104, 1079, 0}, [661] = {1103, 1080, 0}, [662] = {1104, 1080, 0},
    [663] = {1105, 1080, 0}, [664] = {1104, 1081, 0}, [665] = {1105, 1081, 0}, [666] = {1106, 1081, 0}, [667] = {1105, 1082, 0}, [668] = {1106, 1082, 0},
    [669] = {74, 68, 0}, [670] = {75, 68, 0}, [671] = {74, 69, 0}, [672] = {75, 69, 0}, [673] = {76, 69, 0}, [674] = {75, 70, 0},
    [675] = {76, 70, 0}, [676] = {90, 70, 0}, [677] = {76, 106, 0}, [678] = {90, 106, 0}, [679] = {91, 106, 0}, [680] = {90, 107, 0},
    [681] = {91, 107, 0}, [682] = {92, 107, 0}, [683] = {91, 108, 0}, [684] = {92, 108, 0}, [685] = {93, 108, 0}, [686] = {92, 109, 0},
    [687] = {93, 109, 0}, [688] = {343, 109, 0}, [689] = {93, 352, 0}, [690] = {343, 352, 0}, [691] = {349, 352, 0}, [692] = {343, 357, 0},
    [693] = {349, 357, 0}, [694] = {358, 357, 0}, [695] = {349, 362, 0}, [696] = {358, 362, 0}, [697] = {363, 362, 0}, [698] = {358, 367, 0},
    [699] = {363, 367, 0}, [700] = {368, 367, 0}, [701] = {363, 372, 0}, [702] = {368, 372, 0}, [703] = {403, 372, 0}, [704] = {368, 410, 0},
    [705] = {403, 410, 0}, [706] = {404, 410, 0}, [707] = {403, 412, 0}, [708] = {404, 412, 0}, [709] = {883, 412, 0}, [710] = {404, 684, 0},
    [711] = {883, 684, 0}, [712] = {983, 684, 0}, [713] = {883, 1043, 0}, [714] = {983, 1043, 0}, [715] = {1094, 1043, 0}, [716] = {983, 1044, 0},
    [717] = {1094, 1044, 0}, [718] = {1095, 1044, 0}, [719] = {1094, 1045, 0}, [720] = {1095, 1045, 0}, [721] = {1096, 1045, 0}, [722] = {1095, 1046, 0},
    [723] = {1096, 1046, 0}, [724] = {1097, 1046, 0}, [725] = {1096, 1047, 0}, [726] = {1097, 1047, 0}, [727] = {1098, 1047, 0}, [728] = {1097, 1048, 0},
    [729] = {1098, 1048, 0}, [730] = {1099, 1048, 0}, [731] = {1098, 1049, 0}, [732] = {1099, 1049, 0}, [733] = {1100, 1049, 0}, [734] = {1099, 1050, 0},
    [735] = {1100, 1050, 0}, [736] = {1101, 1050, 0}, [737] = {1100, 1051, 0}, [738] = {1101, 1051, 0}, [739] = {1102, 1051, 0}, [740] = {1101, 1052, 0},
    [741] = {1102, 1052, 0}, [742] = {1103, 1052, 0}, [743] = {1102, 1053, 0}, [744] = {1103, 1053, 0}, [745] = {1104, 1053, 0}, [746] = {1103, 1054, 0},
    [747] = {1104, 1054, 0}, [748] = {1105, 1054, 0}, [749] = {1104, 1055, 0}, [750] = {1105, 1055, 0}, [751] = {1106, 1055, 0}, [752] = {1105, 1056, 0},
    [753] = {1106, 1056, 0}, [754] = {79, 82, 0}, [755] = {80, 82, 0}, [756] = {79, 83, 0}, [757] = {80, 83, 0}, [758] = {81, 83, 0},
    [759] = {80, 84, 0}, [760] = {81, 84, 0}, [761] = {94, 84, 0}, [762] = {81, 98, 0}, [763] = {94, 98, 0}, [764] = {95, 98, 0},
    [765] = {94, 99, 0}, [766] = {95, 99, 0}, [767] = {96, 99, 0}, [768] = {95, 100, 0}, [769] = {96, 100, 0}, [770] = {97, 100, 0},
    [771] = {96, 101, 0}, [772] = {97, 101, 0}, [773] = {350, 101, 0}, [774] = {97, 351, 0}, [775] = {350, 351, 0}, [776] = {354, 351, 0},
    [777] = {350, 355, 0}, [778] = {354, 355, 0}, [779] = {359, 355, 0}, [780] = {354, 360, 0}, [781] = {359, 360, 0}, [782] = {364, 360, 0},
    [783] = {359, 365, 0}, [784] = {364, 365, 0}, [785] = {369, 365, 0}, [786] = {364, 370, 0}, [787] = {369, 370, 0}, [788] = {405, 370, 0},
    [789] = {369, 407, 0}, [790] = {405, 407, 0}, [791] = {406, 407, 0}, [792] = {405, 408, 0}, [793] = {406, 408, 0}, [794] = {1118, 408, 0},
    [795] = {406, 1144, 0}, [796] = {1118, 1144, 0}, [797] = {1119, 1144, 0}, [798] = {1118, 1145, 0}, [799] = {1119, 1145, 0}, [800] = {1120, 1145, 0},
    [801] = {1119, 1146, 0}, [802] = {1120, 1146, 0}, [803] = {1121, 1146, 0}, [804] = {1120, 1147, 0}, [805] = {1121, 1147, 0}, [806] = {1122, 1147, 0},
    [807] = {1121, 1148, 0}, [808] = {1122, 1148, 0}, [809] = {1123, 1148, 0}, [810] = {1122, 1149, 0}, [811] = {1123, 1149, 0}, [812] = {1124, 1149, 0},
    [813] = {1123, 1150, 0}, [814] = {1124, 1150, 0}, [815] = {1125, 1150, 0}, [816] = {1124, 1151, 0}, [817] = {1125, 1151, 0}, [818] = {1126, 1151, 0},
    [819] = {1125, 1152, 0}, [820] = {1126, 1152, 0}, [821] = {1127, 1152, 0}, [822] = {1126, 1153, 0}, [823] = {1127, 1153, 0}, [824] = {1128, 1153, 0},
    [825] = {1127, 1154, 0}, [826] = {1128, 1154, 0}, [827] = {1129, 1154, 0}, [828] = {1128, 1155, 0}, [829] = {1129, 1155, 0}, [830] = {1130, 1155, 0},
    [831] = {1129, 1156, 0}, [832] = {1130, 1156, 0}, [833] = {1131, 1156, 0}, [834] = {1130, 1157, 0}, [835] = {1131, 1157, 0}, [836] = {1132, 1157, 0},
    [837] = {1131, 1158, 0}, [838] = {1132, 1158, 0}, [839] = {79, 71, 0}, [840] = {80, 71, 0}, [841] = {79, 72, 0}, [842] = {80, 72, 0},
    [843] = {81, 72, 0}, [844] = {80, 73, 0}, [845] = {81, 73, 0}, [846] = {94, 73, 0}, [847] = {81, 102, 0}, [848] = {94, 102, 0},
    [849] = {95, 102, 0}, [850] = {94, 103, 0}, [851] = {95, 103, 0}, [852] = {96, 103, 0}, [853] = {95, 104, 0}, [854] = {96, 104, 0},
    [855] = {97, 104, 0}, [856] = {96, 105, 0}, [857] = {97, 105, 0}, [858] = {350, 105, 0}, [859] = {97, 353, 0}, [860] = {350, 353, 0},
    [861] = {354, 353, 0}, [862] = {350, 356, 0}, [863] = {354, 356, 0}, [864] = {359, 356, 0}, [865] = {354, 361, 0}, [866] = {359, 361, 0},
    [867] = {364, 361, 0}, [868] = {359, 366, 0}, [869] = {364, 366, 0}, [870] = {369, 366, 0}, [871] = {364, 371, 0}, [872] = {369, 371, 0},
    [873] = {405, 371, 0}, [874] = {369, 409, 0}, [875] = {405, 409, 0}, [876] = {406, 409, 0}, [877] = {405, 411, 0}, [878] = {406, 411, 0},
    [879] = {1118, 411, 0}, [880] = {406, 1068, 0}, [881] = {1118, 1068, 0}, [882] = {1119, 1068, 0}, [883] = {1118, 1069, 0}, [884] = {1119, 1069, 0},
    [885] = {1120, 1069, 0}, [886] = {1119, 1070, 0}, [887] = {1120, 1070, 0}, [888] = {1121, 1070, 0}, [889] = {1120, 1071, 0}, [890] = {1121, 1071, 0},
    [891] = {1122, 1071, 0}, [892] = {1121, 1072, 0}, [893] = {1122, 1072, 0}, [894] = {1123, 1072, 0}, [895] = {1122, 1073, 0}, [896] = {1123, 1073, 0},
    [897] = {1124, 1073, 0}, [898] = {1123, 1074, 0}, [899] = {1124, 1074, 0}, [900] = {1125, 1074, 0}, [901] = {1124, 1075, 0}, [902] = {1125, 1075, 0},
    [903] = {1126, 1075, 0}, [904] = {1125, 1076, 0}, [905] = {1126, 1076, 0}, [906] = {1127, 1076, 0}, [907] = {1126, 1077, 0}, [908] = {1127, 1077, 0},
    [909] = {1128, 1077, 0}, [910] = {1127, 1078, 0}, [911] = {1128, 1078, 0}, [912] = {1129, 1078, 0}, [913] = {1128, 1079, 0}, [914] = {1129, 1079, 0},
    [915] = {1130, 1079, 0}, [916] = {1129, 1080, 0}, [917] = {1130, 1080, 0}, [918] = {1131, 1080, 0}, [919] = {1130, 1081, 0}, [920] = {1131, 1081, 0},
    [921] = {1132, 1081, 0}, [922] = {1131, 1082, 0}, [923] = {1132, 1082, 0}, [924] = {79, 68, 0}, [925] = {80, 68, 0}, [926] = {79, 69, 0},
    [927] = {80, 69, 0}, [928] = {81, 69, 0}, [929] = {80, 70, 0}, [930] = {81, 70, 0}, [931] = {94, 70, 0}, [932] = {81, 106, 0},
    [933] = {94, 106, 0}, [934] = {95, 106, 0}, [935] = {94, 107, 0}, [936] = {95, 107, 0}, [937] = {96, 107, 0}, [938] = {95, 108, 0},
    [939] = {96, 108, 0}, [940] = {97, 108, 0}, [941] = {96, 109, 0}, [942] = {97, 109, 0}, [943] = {350, 109, 0}, [944] = {97, 352, 0},
    [945] = {350, 352, 0}, [946] = {354, 352, 0}, [947] = {350, 357, 0}, [948] = {354, 357, 0}, [949] = {359, 357, 0}, [950] = {354, 362, 0},
    [951] = {359, 362, 0}, [952] = {364, 362, 0}, [953] = {359, 367, 0}, [954] = {364, 367, 0}, [955] = {369, 367, 0}, [956] = {364, 372, 0},
    [957] = {369, 372, 0}, [958] = {405, 372, 0}, [959] = {369, 410, 0}, [960] = {405, 410, 0}, [961] = {406, 410, 0}, [962] = {405, 412, 0},
    [963] = {406, 412, 0}, [964] = {1118, 412, 0}, [965] = {406, 684, 0}, [966] = {1118, 684, 0}, [967] = {1119, 684, 0}, [968] = {1118, 1043, 0},
    [969] = {1119, 1043, 0}, [970] = {1120, 1043, 0}, [971] = {1119, 1044, 0}, [972] = {1120, 1044, 0}, [973] = {1121, 1044, 0}, [974] = {1120, 1045, 0},
    [975] = {1121, 1045, 0}, [976] = {1122, 1045, 0}, [977] = {1121, 1046, 0}, [978] = {1122, 1046, 0}, [979] = {1123, 1046, 0}, [980] = {1122, 1047, 0},
    [981] = {1123, 1047, 0}, [982] = {1124, 1047, 0}, [983] = {1123, 1048, 0}, [984] = {1124, 1048, 0}, [985] = {1125, 1048, 0}, [986] = {1124, 1049, 0},
    [987] = {1125, 1049, 0}, [988] = {1126, 1049, 0}, [989] = {1125, 1050, 0}, [990] = {1126, 1050, 0}, [991] = {1127, 1050, 0}, [992] = {1126, 1051, 0},
    [993] = {1127, 1051, 0}, [994] = {1128, 1051, 0}, [995] = {1127, 1052, 0}, [996] = {1128, 1052, 0}, [997] = {1129, 1052, 0}, [998] = {1128, 1053, 0},
    [999] = {1129, 1053, 0}, [1000] = {1130, 1053, 0}, [1001] = {1129, 1054, 0}, [1002] = {1130, 1054, 0}, [1003] = {1131, 1054, 0}, [1004] = {1130, 1055, 0},
    [1005] = {1131, 1055, 0}, [1006] = {1132, 1055, 0}, [1007] = {1131, 1056, 0}, [1008] = {1132, 1056, 0}, [1009] = {82, 71, 0}, [1010] = {83, 71, 0},
    [1011] = {82, 72, 0}, [1012] = {83, 72, 0}, [1013] = {84, 72, 0}, [1014] = {83, 73, 0}, [1015] = {84, 73, 0}, [1016] = {98, 73, 0},
    [1017] = {84, 102, 0}, [1018] = {98, 102, 0}, [1019] = {99, 102, 0}, [1020] = {98, 103, 0}, [1021] = {99, 103, 0}, [1022] = {100, 103, 0},
    [1023] = {99, 104, 0}, [1024] = {100, 104, 0}, [1025] = {101, 104, 0}, [1026] = {100, 105, 0}, [1027] = {101, 105, 0}, [1028] = {351, 105, 0},
    [1029] = {101, 353, 0}, [1030] = {351, 353, 0}, [1031] = {355, 353, 0}, [1032] = {351, 356, 0}, [1033] = {355, 356, 0}, [1034] = {360, 356, 0},
    [1035] = {355, 361, 0}, [1036] = {360, 361, 0}, [1037] = {365, 361, 0}, [1038] = {360, 366, 0}, [1039] = {365, 366, 0}, [1040] = {370, 366, 0},
    [1041] = {365, 371, 0}, [1042] = {370, 371, 0}, [1043] = {407, 371, 0}, [1044] = {370, 409, 0}, [1045] = {407, 409, 0}, [1046] = {408, 409, 0},
    [1047] = {407, 411, 0}, [1048] = {408, 411, 0}, [1049] = {1144, 411, 0}, [1050] = {408, 1068, 0}, [1051] = {1144, 1068, 0}, [1052] = {1145, 1068, 0},
    [1053] = {1144, 1069, 0}, [1054] = {1145, 1069, 0}, [1055] = {1146, 1069, 0}, [1056] = {1145, 1070, 0}, [1057] = {1146, 1070, 0}, [1058] = {1147, 1070, 0},
    [1059] = {1146, 1071, 0}, [1060] = {1147, 1071, 0}, [1061] = {1148, 1071, 0}, [1062] = {1147, 1072, 0}, [1063] = {1148, 1072, 0}, [1064] = {1149, 1072, 0},
    [1065] = {1148, 1073, 0}, [1066] = {1149, 1073, 0}, [1067] = {1150, 1073, 0}, [1068] = {1149, 1074, 0}, [1069] = {1150, 1074, 0}, [1070] = {1151, 1074, 0},
    [1071] = {1150, 1075, 0}, [1072] = {1151, 1075, 0}, [1073] = {1152, 1075, 0}, [1074] = {1151, 1076, 0}, [1075] = {1152, 1076, 0}, [1076] = {1153, 1076, 0},
    [1077] = {1152, 1077, 0}, [1078] = {1153, 1077, 0}, [1079] = {1154, 1077, 0}, [1080] = {1153, 1078, 0}, [1081] = {1154, 1078, 0}, [1082] = {1155, 1078, 0},
    [1083] = {1154, 1079, 0}, [1084] = {1155, 1079, 0}, [1085] = {1156, 1079, 0}, [1086] = {1155, 1080, 0}, [1087] = {1156, 1080, 0}, [1088] = {1157, 1080, 0},
    [1089] = {1156, 1081, 0}, [1090] = {1157, 1081, 0}, [1091] = {1158, 1081, 0}, [1092] = {1157, 1082, 0}, [1093] = {1158, 1082, 0}, [1094] = {82, 68, 0},
    [1095] = {83, 68, 0}, [1096] = {82, 69, 0}, [1097] = {83, 69, 0}, [1098] = {84, 69, 0}, [1099] = {83, 70, 0}, [1100] = {84, 70, 0},
    [1101] = {98, 70, 0}, [1102] = {84, 106, 0}, [1103] = {98, 106, 0}, [1104] = {99, 106, 0}, [1105] = {98, 107, 0}, [1106] = {99, 107, 0},
    [1107] = {100, 107, 0}, [1108] = {99, 108, 0}, [1109] = {100, 108, 0}, [1110] = {101, 108, 0}, [1111] = {100, 109, 0}, [1112] = {101, 109, 0},
    [1113] = {351, 109, 0}, [1114] = {101, 352, 0}, [1115] = {351, 352, 0}, [1116] = {355, 352, 0}, [1117] = {351, 357, 0}, [1118] = {355, 357, 0},
    [1119] = {360, 357, 0}, [1120] = {355, 362, 0}, [1121] = {360, 362, 0}, [1122] = {365, 362, 0}, [1123] = {360, 367, 0}, [1124] = {365, 367, 0},
    [1125] = {370, 367, 0}, [1126] = {365, 372, 0}, [1127] = {370, 372, 0}, [1128] = {407, 372, 0}, [1129] = {370, 410, 0}, [1130] = {407, 410, 0},
    [1131] = {408, 410, 0}, [1132] = {407, 412, 0}, [1133] = {408, 412, 0}, [1134] = {1144, 412, 0}, [1135] = {408, 684, 0}, [1136] = {1144, 684, 0},
    [1137] = {1145, 684, 0}, [1138] = {1144, 1043, 0}, [1139] = {1145, 1043, 0}, [1140] = {1146, 1043, 0}, [1141] = {1145, 1044, 0}, [1142] = {1146, 1044, 0},
    [1143] = {1147, 1044, 0}, [1144] = {1146, 1045, 0}, [1145] = {1147, 1045, 0}, [1146] = {1148, 1045, 0}, [1147] = {1147, 1046, 0}, [1148] = {1148, 1046, 0},
    [1149] = {1149, 1046, 0}, [1150] = {1148, 1047, 0}, [1151] = {1149, 1047, 0}, [1152] = {1150, 1047, 0}, [1153] = {1149, 1048, 0}, [1154] = {1150, 1048, 0},
    [1155] = {1151, 1048, 0}, [1156] = {1150, 1049, 0}, [1157] = {1151, 1049, 0}, [1158] = {1152, 1049, 0}, [1159] = {1151, 1050, 0}, [1160] = {1152, 1050, 0},
    [1161] = {1153, 1050, 0}, [1162] = {1152, 1051, 0}, [1163] = {1153, 1051, 0}, [1164] = {1154, 1051, 0}, [1165] = {1153, 1052, 0}, [1166] = {1154, 1052, 0},
    [1167] = {1155, 1052, 0}, [1168] = {1154, 1053, 0}, [1169] = {1155, 1053, 0}, [1170] = {1156, 1053, 0}, [1171] = {1155, 1054, 0}, [1172] = {1156, 1054, 0},
    [1173] = {1157, 1054, 0}, [1174] = {1156, 1055, 0}, [1175] = {1157, 1055, 0}, [1176] = {1158, 1055, 0}, [1177] = {1157, 1056, 0}, [1178] = {1158, 1056, 0},
    [1179] = {71, 68, 0}, [1180] = {72, 68, 0}, [1181] = {71, 69, 0}, [1182] = {72, 69, 0}, [1183] = {73, 69, 0}, [1184] = {72, 70, 0},
    [1185] = {73, 70, 0}, [1186] = {102, 70, 0}, [1187] = {73, 106, 0}, [1188] = {102, 106, 0}, [1189] = {103, 106, 0}, [1190] = {102, 107, 0},
    [1191] = {103, 107, 0}, [1192] = {104, 107, 0}, [1193] = {103, 108, 0}, [1194] = {104, 108, 0}, [1195] = {105, 108, 0}, [1196] = {104, 109, 0},
    [1197] = {105, 109, 0}, [1198] = {353, 109, 0}, [1199] = {105, 352, 0}, [1200] = {353, 352, 0}, [1201] = {356, 352, 0}, [1202] = {353, 357, 0},
    [1203] = {356, 357, 0}, [1204] = {361, 357, 0}, [1205] = {356, 362, 0}, [1206] = {361, 362, 0}, [1207] = {366, 362, 0}, [1208] = {361, 367, 0},
    [1209] = {366, 367, 0}, [1210] = {371, 367, 0}, [1211] = {366, 372, 0}, [1212] = {371, 372, 0}, [1213] = {409, 372, 0}, [1214] = {371, 410, 0},
    [1215] = {409, 410, 0}, [1216] = {411, 410, 0}, [1217] = {409, 412, 0}, [1218] = {411, 412, 0}, [1219] = {1068, 412, 0}, [1220] = {411, 684, 0},
    [1221] = {1068, 684, 0}, [1222] = {1069, 684, 0}, [1223] = {1068, 1043, 0}, [1224] = {1069, 1043, 0}, [1225] = {1070, 1043, 0}, [1226] = {1069, 1044, 0},
    [1227] = {1070, 1044, 0}, [1228] = {1071, 1044, 0}, [1229] = {1070, 1045, 0}, [1230] = {1071, 1045, 0}, [1231] = {1072, 1045, 0}, [1232] = {1071, 1046, 0},
    [1233] = {1072, 1046, 0}, [1234] = {1073, 1046, 0}, [1235] = {1072, 1047, 0}, [1236] = {1073, 1047, 0}, [1237] = {1074, 1047, 0}, [1238] = {1073, 1048, 0},
    [1239] = {1074, 1048, 0}, [1240] = {1075, 1048, 0}, [1241] = {1074, 1049, 0}, [1242] = {1075, 1049, 0}, [1243] = {1076, 1049, 0}, [1244] = {1075, 1050, 0},
    [1245] = {1076, 1050, 0}, [1246] = {1077, 1050, 0}, [1247] = {1076, 1051, 0}, [1248] = {1077, 1051, 0}, [1249] = {1078, 1051, 0}, [1250] = {1077, 1052, 0},
    [1251] = {1078, 1052, 0}, [1252] = {1079, 1052, 0}, [1253] = {1078, 1053, 0}, [1254] = {1079, 1053, 0}, [1255] = {1080, 1053, 0}, [1256] = {1079, 1054, 0},
    [1257] = {1080, 1054, 0}, [1258] = {1081, 1054, 0}, [1259] = {1080, 1055, 0}, [1260] = {1081, 1055, 0}, [1261] = {1082, 1055, 0}, [1262] = {1081, 1056, 0},
    [1263] = {1082, 1056, 0}, [1267] = {1209, 0, 0}, [1268] = {1210, 0, 0}, [1269] = {1211, 0, 0}, [1270] = {1212, 0, 0}, [1271] = {1213, 0, 0},
    [1272] = {1214, 0, 0}, [1273] = {1203, 0, 0}, [1274] = {1204, 0, 0}, [1275] = {1205, 0, 0}, [1276] = {1206, 0, 0}, [1277] = {1207, 0, 0},
    [1278] = {1208, 0, 0}, [1279] = {1215, 0, 0}, [1280] = {1216, 0, 0}, [1281] = {1217, 0, 0}, [1282] = {1218, 0, 0}, [1283] = {1219, 0, 0},
    [1284] = {1220, 0, 0}, [1285] = {1221, 0, 0}, [1286] = {1222, 0, 0}, [1287] = {1223, 0, 0}, [1288] = {1224, 0, 0}, [1289] = {1225, 0, 0},
    [1290] = {1226, 0, 0}, [1291] = {1227, 0, 0}, [1292] = {1228, 0, 0}, [1293] = {1229, 0, 0}, [1294] = {1230, 0, 0}, [1295] = {1231, 0, 0},
    [1296] = {1232, 0, 0}, [1307] = {1243, 0, 0}, [1308] = {1244, 0, 0}, [1309] = {1245, 0, 0}, [1310] = {1246, 0, 0}, [1311] = {1247, 0, 0},
    [1312] = {1248, 0, 0}, [1313] = {1249, 0, 0}, [1314] = {1250, 0, 0}, [1315] = {1251, 0, 0}, [1316] = {1252, 0, 0}, [1317] = {1253, 0, 0},
    [1318] = {1254, 0, 0}, [1319] = {1255, 0, 0}, [1320] = {1256, 0, 0}, [1321] = {1257, 0, 0}, [1322] = {1258, 0, 0}, [1323] = {1259, 0, 0},
    [1324] = {1260, 0, 0}, [1325] = {1261, 0, 0}, [1326] = {1262, 0, 0}, [1327] = {1263, 0, 0}, [1328] = {1264, 0, 0}, [1329] = {1265, 0, 0},
    [1330] = {1266, 0, 0}, [1331] = {1267, 0, 0}, [1332] = {1268, 0, 0}, [1333] = {1269, 0, 0}, [1334] = {1270, 0, 0}, [1335] = {1271, 0, 0},
    [1336] = {1272, 0, 0}, [1337] = {1273, 0, 0}, [1338] = {1274, 0, 0}, [1339] = {1275, 0, 0}, [1340] = {1276, 0, 0}, [1341] = {1277, 0, 0},
    [1342] = {1278, 0, 0}, [1343] = {1279, 0, 0}, [1344] = {1280, 0, 0}, [1345] = {1281, 0, 0}, [1346] = {1282, 0, 0}, [1347] = {1283, 0, 0},
    [1348] = {1284, 0, 0}, [1349] = {1285, 0, 0}, [1350] = {1286, 0, 0}, [1351] = {1287, 0, 0}, [1352] = {1288, 0, 0}, [1353] = {1289, 0, 0},
    [1354] = {1290, 0, 0}, [1355] = {1291, 0, 0}, [1356] = {1292, 0, 0}, [1357] = {1293, 0, 0}, [1358] = {1294, 0, 0}, [1359] = {1295, 0, 0},
    [1360] = {1296, 0, 0}, [1361] = {1297, 0, 0}, [1362] = {1298, 0, 0}, [1363] = {1299, 0, 0}, [1364] = {1300, 0, 0}, [1365] = {1301, 0, 0},
    [1366] = {1302, 0, 0}, [1367] = {1303, 0, 0}, [1368] = {1304, 0, 0}, [1369] = {1305, 0, 0}, [1370] = {1306, 0, 0}, [1371] = {1307, 0, 0},
    [1372] = {1308, 0, 0}, [1373] = {1309, 0, 0}, [1374] = {1310, 0, 0}, [1375] = {1311, 0, 0}, [1376] = {1312, 0, 0}, [1377] = {1313, 0, 0},
    [1378] = {1314, 0, 0}, [1379] = {1315, 0, 0}, [1380] = {1316, 0, 0}, [1381] = {1317, 0, 0}, [1382] = {1318, 0, 0}, [1383] = {1319, 0, 0},
    [1384] = {1320, 0, 0}, [1385] = {1321, 0, 0}, [1386] = {1322, 0, 0}, [1387] = {1323, 0, 0}, [1388] = {1324, 0, 0}, [1389] = {1325, 0, 0},
    [1390] = {1326, 0, 0}, [1391] = {1327, 0, 0}, [1392] = {1328, 0, 0}, [1393] = {1329, 0, 0}, [1394] = {1330, 0, 0}, [1395] = {1331, 0, 0},
    [1396] = {1332, 0, 0}, [1397] = {1333, 0, 0}, [1398] = {1334, 0, 0}, [1399] = {1335, 0, 0}, [1400] = {1336, 0, 0}, [1401] = {1337, 0, 0},
    [1402] = {1338, 0, 0}, [1403] = {1339, 0, 0}, [1404] = {1340, 0, 0}, [1405] = {1341, 0, 0}, [1406] = {1342, 0, 0}, [1407] = {1343, 0, 0},
    [1408] = {1344, 0, 0}, [1409] = {1345, 0, 0}, [1410] = {1346, 0, 0}, [1411] = {1347, 0, 0}, [1412] = {1348, 0, 0}, [1413] = {1349, 0, 0},
    [1414] = {1350, 0, 0}, [1415] = {1351, 0, 0}, [1416] = {1352, 0, 0}, [1417] = {1353, 0, 0}, [1418] = {1354, 0, 0}, [1419] = {1355, 0, 0},
    [1420] = {1356, 0, 0}, [1421] = {1357, 0, 0}, [1422] = {1358, 0, 0}, [1423] = {1359, 0, 0}, [1424] = {1360, 0, 0}, [1425] = {1361, 0, 0},
    [1426] = {1362, 0, 0}, [1427] = {1363, 0, 0}, [1428] = {1364, 0, 0}, [1429] = {1365, 0, 0}, [1430] = {1366, 0, 0}, [1431] = {1367, 0, 0},
    [1432] = {1368, 0, 0}, [1433] = {1369, 0, 0}, [1434] = {1370, 0, 0}, [1435] = {1371, 0, 0}, [1436] = {1372, 0, 0}, [1437] = {1373, 0, 0},
    [1438] = {1374, 0, 0}, [1439] = {1375, 0, 0}, [1440] = {1376, 0, 0}, [1441] = {1377, 0, 0}, [1442] = {1378, 0, 0}, [1443] = {1379, 0, 0},
    [1444] = {1380, 0, 0}, [1445] = {1427, 0, 0}, [1446] = {1428, 0, 0}, [1447] = {1429, 0, 0}, [1448] = {1430, 0, 0}, [1449] = {1431, 0, 0},
    [1450] = {1432, 0, 0}, [1451] = {1433, 0, 0}, [1452] = {1434, 0, 0}, [1453] = {1435, 0, 0}, [1454] = {1436, 0, 0}, [1455] = {1437, 0, 0},
    [1456] = {1438, 0, 0}, [1457] = {1439, 0, 0}, [1458] = {1440, 0, 0}, [1459] = {1441, 0, 0}, [1460] = {1442, 0, 0}, [1461] = {1443, 0, 0},
    [1462] = {1444, 0, 0}, [1463] = {1445, 0, 0}, [1464] = {1446, 0, 0}, [1465] = {1447, 0, 0}, [1466] = {1448, 0, 0}, [1467] = {1449, 0, 0},
    [1468] = {1450, 0, 0}, [1469] = {1451, 0, 0}, [1470] = {1452, 0, 0}, [1471] = {1453, 0, 0}, [1472] = {1454, 0, 0}, [1473] = {1455, 0, 0},
    [1474] = {1456, 0, 0}, [1475] = {1457, 0, 0}, [1476] = {1458, 0, 0}, [1477] = {1459, 0, 0}, [1478] = {1460, 0, 0}, [1479] = {1461, 0, 0},
    [1480] = {1462, 0, 0}, [1481] = {1463, 0, 0}, [1482] = {1464, 0, 0}, [1483] = {1465, 0, 0}, [1484] = {1466, 0, 0}, [1485] = {1467, 0, 0},
    [1486] = {1468, 0, 0}, [1487] = {1469, 0, 0}, [1488] = {1470, 0, 0}, [1489] = {1471, 0, 0}, [1490] = {1472, 0, 0}, [1491] = {1381, 0, 0},
    [1492] = {1382, 0, 0}, [1493] = {1383, 0, 0}, [1494] = {1384, 0, 0}, [1495] = {1385, 0, 0}, [1496] = {1386, 0, 0}, [1497] = {1387, 0, 0},
    [1498] = {1388, 0, 0}, [1499] = {1389, 0, 0}, [1500] = {1390, 0, 0}, [1501] = {1391, 0, 0}, [1502] = {1392, 0, 0}, [1503] = {1393, 0, 0},
    [1504] = {1394, 0, 0}, [1505] = {1395, 0, 0}, [1506] = {1396, 0, 0}, [1507] = {1397, 0, 0}, [1508] = {1398, 0, 0}, [1509] = {1399, 0, 0},
    [1510] = {1400, 0, 0}, [1511] = {1401, 0, 0}, [1512] = {1402, 0, 0}, [1513] = {1403, 0, 0}, [1514] = {1404, 0, 0}, [1515] = {1405, 0, 0},
    [1516] = {1406, 0, 0}, [1517] = {1407, 0, 0}, [1518] = {1408, 0, 0}, [1519] = {1409, 0, 0}, [1520] = {1410, 0, 0}, [1521] = {1411, 0, 0},
    [1522] = {1412, 0, 0}, [1523] = {1413, 0, 0}, [1524] = {1414, 0, 0}, [1525] = {1415, 0, 0}, [1526] = {1416, 0, 0}, [1527] = {1417, 0, 0},
    [1528] = {1418, 0, 0}, [1529] = {1419, 0, 0}, [1530] = {1420, 0, 0}, [1531] = {1421, 0, 0}, [1532] = {1422, 0, 0}, [1533] = {1423, 0, 0},
    [1534] = {1424, 0, 0}, [1535] = {1425, 0, 0}, [1536] = {1426, 0, 0}, [1547] = {1563, 0, 0}, [1548] = {1583, 0, 0}, [1549] = {1584, 0, 0},
    [1550] = {1585, 0, 0}, [1551] = {1586, 0, 0}, [1552] = {1587, 0, 0}, [1553] = {1588, 0, 0}, [1554] = {1589, 0, 0}, [1555] = {1590, 0, 0},
    [1556] = {1591, 0, 0}, [1557] = {1592, 0, 0}, [1558] = {1593, 0, 0}, [1559] = {1594, 0, 0}, [1560] = {1595, 0, 0}, [1561] = {1596, 0, 0},
    [1562] = {1597, 0, 0}, [1563] = {1598, 0, 0}, [1564] = {1599, 0, 0}, [1565] = {1600, 0, 0}, [1566] = {1601, 0, 0}, [1567] = {1602, 0, 0},
    [1568] = {1603, 0, 0}, [1569] = {1604, 0, 0}, [1570] = {1605, 0, 0}, [1571] = {1606, 0, 0}, [1572] = {1607, 0, 0}, [1573] = {1608, 0, 0},
    [1574] = {1609, 0, 0}, [1575] = {1610, 0, 0}, [1576] = {1611, 0, 0}, [1577] = {1612, 0, 0}, [1578] = {1613, 0, 0}, [1579] = {1614, 0, 0},
    [1580] = {1615, 0, 0}, [1581] = {1616, 0, 0}, [1582] = {1617, 0, 0}, [1583] = {1618, 0, 0}, [1584] = {1619, 0, 0}, [1585] = {1620, 0, 0},
    [1586] = {1621, 0, 0}, [1587] = {1622, 0, 0}, [1588] = {1623, 0, 0}, [1589] = {1624, 0, 0}, [1590] = {1625, 0, 0}, [1591] = {1626, 0, 0},
    [1592] = {1627, 0, 0}, [1607] = {1943, 0, 0}, [1608] = {1944, 0, 0}, [1609] = {1945, 0, 0}, [1610] = {1946, 0, 0}, [1611] = {1947, 0, 0},
    [1612] = {1948, 0, 0}, [1613] = {1949, 0, 0}, [1614] = {1950, 0, 0}, [1615] = {1951, 0, 0}, [1616] = {1952, 0, 0}, [1617] = {1953, 0, 0},
    [1618] = {1954, 0, 0}, [1619] = {1955, 0, 0}, [1620] = {1956, 0, 0}, [1621] = {1957, 0, 0}, [1622] = {1958, 0, 0}, [1623] = {1959, 0, 0},
    [1624] = {1960, 0, 0}, [1625] = {1961, 0, 0}, [1626] = {1962, 0, 0}, [1627] = {1963, 0, 0}, [1628] = {1964, 0, 0}, [1629] = {1965, 0, 0},
    [1630] = {1966, 0, 0}, [1631] = {1967, 0, 0}, [1632] = {1968, 0, 0}, [1633] = {1969, 0, 0}, [1634] = {1970, 0, 0}, [1635] = {1971, 0, 0},
    [1636] = {1972, 0, 0}, [1637] = {1973, 0, 0}, [1647] = {1983, 0, 0}, [1648] = {1983, 68, 0}, [1649] = {1983, 68, 0}, [1650] = {1983, 69, 0},
    [1651] = {1983, 69, 0}, [1652] = {1983, 70, 0}, [1653] = {1983, 70, 0}, [1654] = {1983, 106, 0}, [1655] = {1983, 106, 0}, [1656] = {1983, 107, 0},
    [1657] = {1984, 107, 0}, [1658] = {1984, 108, 0}, [1659] = {1984, 108, 0}, [1660] = {1984, 109, 0}, [1661] = {1984, 109, 0}, [1662] = {1984, 352, 0},
    [1663] = {1984, 352, 0}, [1664] = {1984, 357, 0}, [1665] = {1984, 357, 0}, [1666] = {1984, 357, 0}, [1667] = {1985, 357, 0}, [1668] = {1985, 362, 0},
    [1669] = {1985, 362, 0}, [1670] = {1985, 362, 0}, [1671] = {1985, 362, 0}, [1672] = {1985, 367, 0}, [1673] = {1985, 367, 0}, [1674] = {1985, 372, 0},
    [1675] = {1985, 372, 0}, [1676] = {1985, 372, 0}, [1677] = {1986, 372, 0}, [1678] = {1986, 372, 0}, [1679] = {1986, 372, 0}, [1680] = {1986, 372, 0},
    [1681] = {1986, 372, 0}, [1682] = {1986, 410, 0}, [1683] = {1986, 410, 0}, [1684] = {1986, 412, 0}, [1685] = {1986, 412, 0}, [1686] = {1986, 412, 0},
    [1687] = {1986, 412, 0}, [1688] = {1986, 684, 0}, [1689] = {1986, 684, 0}, [1690] = {1986, 1043, 0}, [1691] = {1986, 1043, 0}, [1692] = {1986, 1043, 0},
    [1693] = {1986, 1043, 0}, [1694] = {1986, 1044, 0}, [1695] = {1986, 1044, 0}, [1696] = {1986, 1045, 0}, [1697] = {1986, 1045, 0}, [1698] = {1986, 1045, 0},
    [1699] = {1986, 1045, 0}, [1700] = {1986, 1046, 0}, [1701] = {1986, 1046, 0}, [1702] = {1986, 1047, 0}, [1703] = {1986, 1047, 0}, [1704] = {2040, 0, 0},
    [1705] = {2041, 0, 0}, [1706] = {2042, 0, 0}, [1707] = {2043, 0, 0}, [1708] = {2044, 0, 0}, [1709] = {2045, 0, 0}, [1710] = {2046, 0, 0},
    [1711] = {2047, 0, 0}, [1712] = {2048, 0, 0}, [1713] = {2049, 0, 0}, [1714] = {2050, 0, 0}, [1715] = {2051, 0, 0}, [1716] = {2052, 0, 0},
    [1717] = {2053, 0, 0}, [1718] = {2054, 0, 0}, [1719] = {2055, 0, 0}, [1720] = {2056, 0, 0}, [1721] = {2057, 0, 0}, [1722] = {2058, 0, 0},
    [1723] = {2059, 0, 0}, [1724] = {2060, 0, 0}, [1725] = {2061, 0, 0}, [1726] = {2062, 0, 0}, [1727] = {2063, 0, 0}, [1728] = {2064, 0, 0},
    [1729] = {2065, 0, 0}, [1730] = {2066, 0, 0}, [1731] = {2067, 0, 0}, [1732] = {2068, 0, 0}, [1733] = {2069, 0, 0}, [1734] = {2070, 0, 0},
    [1735] = {2071, 0, 0}, [1736] = {2072, 0, 0}, [1737] = {2073, 0, 0}, [1738] = {2074, 0, 0}, [1739] = {2075, 0, 0}, [1740] = {2076, 0, 0},
    [1741] = {2077, 0, 0}, [1742] = {2078, 0, 0}, [1743] = {2078, 0, 0}, [1744] = {2078, 0, 0}, [1745] = {2078, 0, 0}, [1746] = {2078, 0, 0},
    [1747] = {2078, 0, 0}, [1748] = {2078, 74, 0}, [1749] = {2078, 74, 0}, [1750] = {2078, 74, 0}, [1751] = {2078, 75, 0}, [1752] = {2078, 75, 0},
    [1753] = {2078, 75, 0}, [1754] = {2078, 76, 0}, [1755] = {2078, 76, 0}, [1756] = {2078, 76, 0}, [1757] = {2078, 90, 0}, [1758] = {2078, 90, 0},
    [1759] = {2078, 90, 0}, [1760] = {2078, 91, 0}, [1761] = {2078, 91, 0}, [1762] = {2078, 91, 0}, [1763] = {2078, 92, 0}, [1764] = {2078, 92, 0},
    [1765] = {2078, 92, 0}, [1766] = {2078, 93, 0}, [1767] = {2078, 93, 0}, [1768] = {2078, 93, 0}, [1769] = {2078, 343, 0}, [1770] = {2078, 343, 0},
    [1771] = {2078, 343, 0}, [1772] = {2078, 349, 0}, [1773] = {2078, 349, 0}, [1774] = {2078, 349, 0}, [1775] = {2078, 349, 0}, [1776] = {2078, 349, 0},
    [1777] = {2078, 349, 0}, [1778] = {2078, 349, 0}, [1779] = {2078, 349, 0}, [1780] = {2078, 358, 0}, [1781] = {2078, 358, 0}, [1782] = {2078, 358, 0},
    [1783] = {2078, 363, 0}, [1784] = {2078, 363, 0}, [1785] = {2078, 363, 0}, [1786] = {2078, 368, 0}, [1787] = {2078, 368, 0}, [1788] = {2078, 368, 0},
    [1789] = {2078, 368, 0}, [1790] = {2078, 403, 0}, [1791] = {2078, 403, 0}, [1792] = {2078, 403, 0}, [1793] = {2078, 404, 0}, [1794] = {2078, 404, 0},
    [1795] = {2078, 404, 0}, [1796] = {2078, 404, 0}, [1797] = {2078, 883, 0}, [1798] = {2078, 883, 0}, [1799] = {2079, 0, 0}, [1800] = {2080, 0, 0},
    [1801] = {2081, 0, 0}, [1802] = {2082, 0, 0}, [1803] = {2083, 0, 0}, [1804] = {2084, 0, 0}, [1805] = {2085, 0, 0}, [1806] = {2086, 0, 0},
    [1807] = {2087, 0, 0}, [1808] = {2088, 0, 0}, [1809] = {2089, 0, 0}, [1810] = {2090, 0, 0}, [1811] = {2091, 0, 0}, [1812] = {2092, 0, 0},
    [1813] = {2093, 0, 0}, [1814] = {2094, 0, 0}, [1815] = {2095, 0, 0}, [1816] = {2096, 0, 0}, [1817] = {2097, 0, 0}, [1818] = {2098, 0, 0},
    [1819] = {2099, 0, 0}, [1820] = {2100, 0, 0}, [1821] = {2101, 0, 0}, [1822] = {2102, 0, 0}, [1823] = {2103, 0, 0}, [1824] = {2104, 0, 0},
    [1825] = {2105, 0, 0}, [1826] = {2106, 0, 0}, [1827] = {2107, 0, 0}, [1828] = {2108, 0, 0}, [1829] = {2109, 0, 0}, [1830] = {2110, 0, 0},
    [1831] = {2111, 0, 0}, [1832] = {2112, 0, 0}, [1833] = {2113, 0, 0}, [1834] = {2114, 0, 0}, [1835] = {2115, 0, 0}, [1836] = {2116, 0, 0},
    [1837] = {2117, 0, 0}, [1838] = {2118, 0, 0}, [1839] = {2119, 0, 0}, [1840] = {2120, 0, 0}, [1841] = {2121, 0, 0}, [1842] = {2122, 0, 0},
    [1843] = {2123, 0, 0}, [1844] = {2124, 0, 0}, [1845] = {2125, 0, 0}, [1846] = {2126, 0, 0}, [1847] = {2127, 0, 0}, [1848] = {2128, 0, 0},
    [1849] = {2129, 0, 0}, [1850] = {2130, 0, 0}, [1851] = {2131, 0, 0}, [1852] = {2132, 0, 0}, [1853] = {2133, 0, 0}, [1854] = {2134, 0, 0},
    [1855] = {2135, 0, 0}, [1856] = {2136, 0, 0}, [1857] = {2137, 0, 0}, [1858] = {2138, 0, 0}, [1859] = {2139, 0, 0}, [1860] = {2140, 0, 0},
    [1861] = {2141, 0, 0}, [1862] = {2142, 0, 0}, [1863] = {2143, 0, 0}, [1864] = {2144, 0, 0}, [1865] = {2145, 0, 0}, [1866] = {2146, 0, 0},
    [1867] = {2147, 0, 0}, [1868] = {2148, 0, 0}, [1869] = {2149, 0, 0}, [1870] = {2150, 0, 0}, [1871] = {2151, 0, 0}, [1872] = {2152, 0, 0},
    [1873] = {2153, 0, 0}, [1874] = {2154, 0, 0}, [1875] = {2155, 0, 0}, [1876] = {2156, 0, 0}, [1877] = {2157, 0, 0}, [1878] = {2158, 0, 0},
    [1879] = {2159, 0, 0}, [1880] = {2160, 0, 0}, [1881] = {2161, 0, 0}, [1882] = {2162, 0, 0}, [1883] = {2163, 0, 0}, [1884] = {2164, 0, 0},
    [1885] = {2165, 0, 0}, [1886] = {2166, 0, 0}, [1887] = {2167, 0, 0}, [1888] = {2168, 0, 0}, [1889] = {2169, 0, 0}, [1890] = {2170, 0, 0},
    [1891] = {2171, 0, 0}, [1892] = {2172, 0, 0}, [1893] = {2173, 0, 0}, [1894] = {2174, 0, 0}, [1895] = {2175, 0, 0}, [1896] = {2176, 0, 0},
    [1897] = {2177, 0, 0}, [1898] = {2178, 0, 0}, [1899] = {2179, 0, 0}, [1900] = {2180, 0, 0}, [1901] = {2181, 0, 0}, [1902] = {2182, 0, 0},
    [1903] = {2183, 0, 0}, [1904] = {2184, 0, 0}, [1905] = {2185, 0, 0}, [1906] = {2186, 0, 0}, [1907] = {2187, 0, 0}, [1908] = {2188, 0, 0},
    [1909] = {2189, 0, 0}, [1910] = {2190, 0, 0}, [1911] = {2191, 0, 0}, [1912] = {2192, 0, 0}, [1913] = {2193, 0, 0}, [1914] = {2194, 0, 0},
    [1915] = {2195, 0, 0}, [1916] = {2196, 0, 0}, [1917] = {2197, 0, 0}, [1918] = {2198, 0, 0}, [1919] = {2199, 0, 0}, [1920] = {2200, 0, 0},
    [1921] = {2201, 0, 0}, [1922] = {2202, 0, 0}, [1923] = {2203, 0, 0}, [1924] = {2204, 0, 0}, [1925] = {2205, 0, 0}, [1926] = {2206, 0, 0},
    [1927] = {2207, 0, 0}, [1928] = {2208, 0, 0}, [1929] = {2209, 0, 0}, [1930] = {2210, 0, 0}, [1931] = {2211, 0, 0}, [1932] = {2212, 0, 0},
    [1933] = {2213, 0, 0}, [1934] = {2214, 0, 0}, [1935] = {2215, 0, 0}, [1936] = {2216, 0, 0}, [1937] = {2217, 0, 0}, [1938] = {2218, 0, 0},
    [1939] = {2219, 0, 0}, [1940] = {2220, 0, 0}, [1941] = {2221, 0, 0}, [1942] = {2222, 0, 0}, [1943] = {2223, 0, 0}, [1944] = {2224, 0, 0},
    [1945] = {2225, 0, 0}, [1946] = {2226, 0, 0}, [1947] = {2227, 0, 0}, [1948] = {2228, 0, 0}, [1949] = {2229, 0, 0}, [1950] = {2230, 0, 0},
    [1951] = {2231, 0, 0}, [1952] = {2232, 0, 0}, [1953] = {2233, 0, 0}, [1954] = {2234, 0, 0}, [1955] = {2235, 0, 0}, [1956] = {2236, 0, 0},
    [1957] = {2237, 0, 0}, [1958] = {2238, 0, 0}, [1959] = {2239, 0, 0}, [1960] = {2240, 0, 0}, [1961] = {2241, 0, 0}, [1962] = {2242, 0, 0},
    [1963] = {2243, 0, 0}, [1964] = {2244, 0, 0}, [1965] = {2245, 0, 0}, [1966] = {2246, 0, 0}, [1967] = {2247, 0, 0}, [1968] = {2248, 0, 0},
    [1969] = {2249, 0, 0}, [1970] = {2250, 0, 0}, [1971] = {2251, 0, 0}, [1972] = {2252, 0, 0}, [1973] = {2253, 0, 0}, [1974] = {2254, 0, 0},
    [1975] = {2255, 0, 0}, [1976] = {2256, 0, 0}, [1977] = {2257, 0, 0}, [1978] = {2258, 0, 0}, [1979] = {2259, 0, 0}, [1980] = {2260, 0, 0},
    [1981] = {2261, 0, 0}, [1982] = {2262, 0, 0}, [1983] = {2263, 0, 0}, [1984] = {2264, 0, 0}, [1985] = {2265, 0, 0}, [1986] = {2266, 0, 0},
    [1987] = {2267, 0, 0}, [1988] = {2268, 0, 0}, [1989] = {2269, 0, 0}, [1990] = {2270, 0, 0}, [1991] = {2271, 0, 0}, [1992] = {2272, 0, 0},
    [1993] = {2273, 0, 0}, [1994] = {2274, 0, 0}, [1995] = {2275, 0, 0}, [1996] = {2276, 0, 0}, [1997] = {2277, 0, 0}, [1998] = {2278, 0, 0},
    [1999] = {2279, 0, 0}, [2000] = {2280, 0, 0}, [2001] = {2281, 0, 0}, [2002] = {2282, 0, 0}, [2003] = {2283, 0, 0}, [2004] = {2284, 0, 0},
    [2005] = {2285, 0, 0}, [2006] = {2286, 0, 0}, [2007] = {2287, 0, 0}, [2008] = {2288, 0, 0}, [2009] = {2289, 0, 0}, [2010] = {2290, 0, 0},
    [2011] = {2291, 0, 0}, [2012] = {2292, 0, 0}, [2013] = {2293, 0, 0}, [2014] = {2294, 0, 0}, [2015] = {2295, 0, 0}, [2016] = {2296, 0, 0},
    [2017] = {2297, 0, 0}, [2018] = {2298, 0, 0}, [2019] = {2299, 0, 0}, [2020] = {2300, 0, 0}, [2021] = {2301, 0, 0}, [2022] = {2302, 0, 0},
    [2023] = {2303, 0, 0}, [2024] = {2304, 0, 0}, [2025] = {2305, 0, 0}, [2026] = {2306, 0, 0}, [2027] = {2307, 0, 0}, [2028] = {2308, 0, 0},
    [2029] = {2309, 0, 0}, [2030] = {2310, 0, 0}, [2031] = {2311, 0, 0}, [2032] = {2312, 0, 0}, [2033] = {2313, 0, 0}, [2034] = {2314, 0, 0},
    [2035] = {2315, 0, 0}, [2036] = {2316, 0, 0}, [2037] = {2317, 0, 0}, [2038] = {2318, 0, 0}, [2039] = {2319, 0, 0}, [2040] = {2320, 0, 0},
    [2041] = {2321, 0, 0}, [2042] = {2322, 0, 0}, [2043] = {2323, 0, 0}, [2044] = {2324, 0, 0}, [2045] = {2325, 0, 0}, [2046] = {2326, 0, 0},
    [2047] = {2327, 0, 0}, [2048] = {2328, 0, 0}, [2049] = {2329, 0, 0}, [2050] = {2330, 0, 0}, [2051] = {2331, 0, 0}, [2052] = {2332, 0, 0},
    [2053] = {2333, 0, 0}, [2054] = {2334, 0, 0}, [2055] = {2335, 0, 0}, [2056] = {2336, 0, 0}, [2057] = {2337, 0, 0}, [2058] = {2338, 0, 0},
    [2059] = {2339, 0, 0}, [2060] = {2340, 0, 0}, [2061] = {2341, 0, 0}, [2062] = {2342, 0, 0}, [2063] = {2343, 0, 0}, [2064] = {2344, 0, 0},
    [2067] = {2363, 0, 0}, [2068] = {2364, 0, 0}, [2069] = {2365, 0, 0}, [2070] = {2366, 0, 0}, [2071] = {2367, 0, 0}, [2072] = {2368, 0, 0},
    [2073] = {2369, 0, 0}, [2074] = {2370, 0, 0}, [2075] = {2371, 0, 0}, [2076] = {2372, 0, 0}, [2077] = {2373, 0, 0}, [2078] = {2374, 0, 0},
    [2079] = {2375, 0, 0}, [2080] = {2376, 0, 0}, [2081] = {2377, 0, 0}, [2082] = {2378, 0, 0}, [2083] = {2379, 0, 0}, [2084] = {2380, 0, 0},
    [2085] = {2381, 0, 0}, [2086] = {2382, 0, 0}, [2087] = {2383, 0, 0}, [2088] = {2384, 0, 0}, [2089] = {2385, 0, 0}, [2090] = {2386, 0, 0},
    [2091] = {2387, 0, 0}, [2092] = {2388, 0, 0}, [2093] = {2389, 0, 0}, [2094] = {2390, 0, 0}, [2095] = {2391, 0, 0}, [2096] = {2392, 0, 0},
    [2097] = {2393, 0, 0}, [2098] = {2394, 0, 0}, [2099] = {2395, 0, 0}, [2100] = {2396, 0, 0}, [2101] = {2397, 0, 0}, [2102] = {2398, 0, 0},
    [2103] = {2399, 0, 0}, [2104] = {2400, 0, 0}, [2105] = {2401, 0, 0}, [2106] = {2402, 0, 0}, [2107] = {2403, 0, 0}, [2108] = {2404, 0, 0},
    [2109] = {2405, 0, 0}, [2110] = {2406, 0, 0}, [2111] = {2407, 0, 0}, [2112] = {2408, 0, 0}, [2113] = {2409, 0, 0}, [2114] = {2410, 0, 0},
    [2115] = {2411, 0, 0}, [2116] = {2412, 0, 0}, [2117] = {2413, 0, 0}, [2118] = {2414, 0, 0}, [2119] = {2415, 0, 0}, [2120] = {2416, 0, 0},
    [2121] = {2417, 0, 0}, [2122] = {2418, 0, 0}, [2123] = {2419, 0, 0}, [2124] = {2420, 0, 0}, [2125] = {2421, 0, 0}, [2126] = {2422, 0, 0},
    [2127] = {2423, 0, 0}, [2128] = {2424, 0, 0}, [2129] = {2425, 0, 0}, [2130] = {2426, 0, 0}, [2131] = {2427, 0, 0}, [2132] = {2428, 0, 0},
    [2133] = {2429, 0, 0}, [2134] = {2430, 0, 0}, [2135] = {2431, 0, 0}, [2136] = {2432, 0, 0}, [2137] = {2433, 0, 0}, [2138] = {2434, 0, 0},
    [2139] = {2435, 0, 0}, [2140] = {2436, 0, 0}, [2141] = {2437, 0, 0}, [2142] = {2438, 0, 0}, [2143] = {366, 359, 2607}, [2144] = {366, 359, 2607},
    [2145] = {361, 359, 2608}, [2146] = {361, 2316, 2373}, [2147] = {366, 2316, 2372}, [2148] = {361, 2317, 2372}, [2149] = {367, 358, 361}, [2150] = {362, 363, 361},
    [2151] = {362, 358, 366}, [2152] = {366, 364, 2608}, [2153] = {366, 2317, 2373}, [2154] = {367, 363, 366}, [2155] = {1068, 1118, 2612}, [2156] = {1068, 2321, 2377},
    [2157] = {684, 883, 1068}, [2158] = {410, 403, 409}, [2159] = {409, 405, 2609}, [2160] = {409, 2319, 2375}, [2161] = {366, 364, 2610}, [2162] = {366, 2318, 2373},
    [2163] = {367, 363, 371}, [2164] = {0, 0, 0}
}

local ItemRandomProperty = {} -- For items with randomized names

-- Build filtered item_template query
local ItemTemplateQuery = [[
    SELECT entry, class, subclass, quality, BuyPrice, SellPrice, 
           InventoryType, AllowableClass, ItemLevel, RequiredLevel,
           RequiredSkill, RequiredSkillRank, stackable, startquest,
           bonding, BagFamily, flags, name, MaxDurability, ContainerSlots,
		   RandomProperty, spellcharges_1, spellcharges_2, spellcharges_3,
		   spellcharges_4, spellcharges_5, duration, AllowableRace,
		   RandomSuffix
    FROM item_template
]]

if EnableItemFilters then
	local conditions = {} -- We must use a table to store conditions to ensure we're not overwriting "where" statements, in case any of the filter conditions are empty
	
	if NeverSellIDs then
		table.insert(conditions, "NOT entry IN (" .. table.concat(NeverSellIDs, ',') .. ")")
	end
	
	if MinContainerSize then
		table.insert(conditions, "NOT (class = 1 AND ContainerSlots < "..MinContainerSize..")")
		table.insert(conditions, "NOT (class = 11 AND ContainerSlots < "..MinContainerSize..")")
	end
	
	if AllowedClassItems then
		if AllowGlyphs then
			table.insert(conditions, "(class = 16 OR AllowableClass IN (" .. table.concat(AllowedClassItems, ',') .. "))")
		else
			table.insert(conditions, "AllowableClass IN (" .. table.concat(AllowedClassItems, ',') .. ")")
		end
	end
	
	if not AllowRecipes then
		table.insert(conditions, "NOT (class = 9)")
	end
	
	if not AllowCompanions then
		table.insert(conditions, "NOT (class = 15 and subclass = 2)")
	end
	
	if not AllowMounts then
		table.insert(conditions, "NOT (class = 15 and subclass = 5)")
	end
	
	if not AllowReputationItems then
		table.insert(conditions, "RequiredReputationFaction = 0")
	end
	
	if AllowedHordeRaces then
		table.insert(conditions, "AllowableRace IN (" .. table.concat(AllowedHordeRaces, ',') .. ")")
	end
	
	if AllowedAllyRaces then
		table.insert(conditions, "AllowableRace IN (" .. table.concat(AllowedAllyRaces, ',') .. ")")
	end
	
	if not AllowKeys then
		table.insert(conditions, "(BagFamily & 256) = 0")
		table.insert(conditions, "NOT (class = 13 and subclass = 0)")
	end
	
	if not AllowConjured then
		table.insert(conditions, "(flags & 2) = 0")
	end
	
	if not AllowMisc then
		table.insert(conditions, "(BagFamily & 4) = 0")
		table.insert(conditions, "(BagFamily & 2048) = 0")
		table.insert(conditions, "NOT (class = 15 and subclass = 4)")
	end
	
	if not AllowQuestItems then
		table.insert(conditions, "(BagFamily & 16384) = 0")
		table.insert(conditions, "NOT class = 12")
	end
	
	if not AllowLockpicking then
		table.insert(conditions, "NOT (class = 13 and subclass = 1)")
	end
	
	if not AllowConsumables then
		table.insert(conditions, "NOT (class = 0)")
	end
	
	if not AllowCommonAmmo then
		table.insert(conditions, "NOT (class = 6 and quality < 2)")
	end
	
	if not AllowHolidayItems then
		table.insert(conditions, "NOT (class = 15 and subclass = 3)")
		table.insert(conditions, "HolidayId = 0")
	end 
	
	if AllowedBinds then
		table.insert(conditions, "bonding IN (" .. table.concat(AllowedBinds, ',') .. ")")
	end

	if AllowedQualities then
		table.insert(conditions, "quality IN (" .. table.concat(AllowedQualities, ',') .. ")")
	end

	if not AllowDeprecated then
		-- Obsolete/unused/unavailable items
		table.insert(conditions, "(flags & 16) = 0")
		table.insert(conditions, "NOT (NAME LIKE '%OLD%' AND NAME COLLATE utf8mb4_bin LIKE '%OLD%')")
		table.insert(conditions, "UPPER(NAME) NOT LIKE '%NPC%'")
		table.insert(conditions, "UPPER(NAME) NOT LIKE '%QA%'")
		table.insert(conditions, "UPPER(NAME) NOT LIKE '%enchant ring%'")
		table.insert(conditions, "NAME NOT LIKE '%tablet%'")
		table.insert(conditions, "NAME NOT LIKE '%throwing dagger%'")
		table.insert(conditions, "NAME NOT LIKE '%shot pouch%'")
		table.insert(conditions, "NAME NOT LIKE '%brimstone%'")
		table.insert(conditions, "NAME NOT LIKE '%small pouch%'")
		table.insert(conditions, "NAME NOT LIKE '%stormjewel%'")
		table.insert(conditions, "NAME NOT LIKE '%dye%'")
		table.insert(conditions, "NAME NOT LIKE '%feathers of azeroth%'")
		table.insert(conditions, "NAME NOT LIKE '%broken%throwing%'")
		table.insert(conditions, "NAME NOT LIKE '%northrend meat%'")
		table.insert(conditions, "NAME NOT LIKE '%ironwood seed%'")
		table.insert(conditions, "NAME NOT LIKE '%stranglethorn seed%'")
		table.insert(conditions, "NAME NOT LIKE '%simple wood%'")
		table.insert(conditions, "NAME NOT LIKE '%small sack of coins%'")
		table.insert(conditions, "NAME NOT LIKE '%slimy bag%'")
		table.insert(conditions, "NAME NOT LIKE '%bleach%'")
		table.insert(conditions, "NAME NOT LIKE '%oozing bag%'")
		table.insert(conditions, "NAME NOT LIKE '%Pale Skinner%'")
		table.insert(conditions, "NAME NOT LIKE '%Pioneer Buckler%'")
		table.insert(conditions, "NAME NOT LIKE '%locust wing%'")
		table.insert(conditions, "NAME NOT LIKE '%community token	%'")
		table.insert(conditions, "NAME NOT LIKE '%thick citrine%'")
		table.insert(conditions, "NAME NOT LIKE '%brilliant citrine%'")
		table.insert(conditions, "NAME NOT LIKE '%nightbloom lilac%'")
		table.insert(conditions, "NAME NOT LIKE '%flour%'")
		table.insert(conditions, "NAME NOT LIKE '%brew%'")
		table.insert(conditions, "NAME NOT LIKE '%[PH]%'")
		table.insert(conditions, "NAME NOT LIKE '%(PH)%'")
		table.insert(conditions, "NAME NOT LIKE '%fishing -%'")
		table.insert(conditions, "NAME NOT LIKE '%Sandy Scorpid Claw%'")
		table.insert(conditions, "NAME NOT LIKE '% caster %'")
		table.insert(conditions, "NAME NOT LIKE '%Jeweler''s Kit%'")
		table.insert(conditions, "NAME NOT LIKE '%nightmare berries%'")
		table.insert(conditions, "NAME NOT LIKE '%parchment%'")
		table.insert(conditions, "NAME NOT LIKE '%light quiver%'")
		table.insert(conditions, "NAME NOT LIKE '%honey%'")
		table.insert(conditions, "NAME NOT LIKE '%explosive shell%'")
		table.insert(conditions, "NAME NOT LIKE '%envelope%'")
		table.insert(conditions, "NAME NOT LIKE '%equipment kit%'")
		table.insert(conditions, "NAME NOT LIKE '%/%'")
		table.insert(conditions, "NAME NOT LIKE '%2.0%'")
		table.insert(conditions, "NAME NOT LIKE '%creeping anguish%'")
		table.insert(conditions, "NAME NOT LIKE '%felcloth bag%'")
		table.insert(conditions, "NAME NOT LIKE '%elementium ore%'")
		table.insert(conditions, "NAME NOT LIKE '%unused%'")
		table.insert(conditions, "NAME NOT LIKE '%lava core%'")
		table.insert(conditions, "NAME NOT LIKE '%fiery core%'")
		table.insert(conditions, "NAME NOT LIKE '%sulfuron ingot%'")
		table.insert(conditions, "NAME NOT LIKE '%sak%'")
		table.insert(conditions, "NAME NOT LIKE '%gigantique%'")
		table.insert(conditions, "NAME NOT LIKE '%portable hole%'")
		table.insert(conditions, "NAME NOT LIKE '%deptecated%'")
		table.insert(conditions, "NAME NOT LIKE '%durability%'")
		table.insert(conditions, "NAME NOT LIKE '%big sack%'")
		table.insert(conditions, "NAME NOT LIKE '%decoded%'")
		table.insert(conditions, "NAME NOT LIKE '%knowledge:%'")
		table.insert(conditions, "NAME NOT LIKE '%manual%'")
		table.insert(conditions, "NAME NOT LIKE '%gnome head%'")
		table.insert(conditions, "NAME NOT LIKE '%box of%'")
		table.insert(conditions, "NAME NOT LIKE '%Light Feather%'")
		table.insert(conditions, "NAME NOT LIKE '%Pet Stone%'")
		table.insert(conditions, "NAME NOT LIKE '%Ogrela%'")
		table.insert(conditions, "NAME NOT LIKE '%cache of%'")
		table.insert(conditions, "NAME NOT LIKE '%summoning%'")
		table.insert(conditions, "NAME NOT LIKE '%cut %'")
		table.insert(conditions, "NAME NOT LIKE '%turtle egg%'")
		table.insert(conditions, "NAME NOT LIKE '%jillian%'")
		table.insert(conditions, "NAME NOT LIKE '%heavy crate%'")
		table.insert(conditions, "NAME NOT LIKE '%plain letter%'")
		table.insert(conditions, "NOT (CLASS = 15 AND NAME LIKE '%throw%')")
		table.insert(conditions, "NAME NOT LIKE '%sack of gems%'")
		table.insert(conditions, "NAME NOT LIKE '%plans: darkspear%'")
		table.insert(conditions, "NAME NOT LIKE '%beetle husk%'")
		table.insert(conditions, "NAME NOT LIKE '%froststeel bar%'")
		table.insert(conditions, "NAME NOT LIKE '%firefly dust%'")
		table.insert(conditions, "NAME NOT LIKE '%of swords%'")
		table.insert(conditions, "NAME NOT LIKE '%gnomish alarm%'")
		table.insert(conditions, "NAME NOT LIKE '%tome%'")
		table.insert(conditions, "NOT (NAME LIKE '%broken%' AND NAME LIKE '%throwing%')")
		table.insert(conditions, "NAME NOT LIKE '%ornate spyglass%'")
		table.insert(conditions, "NAME NOT LIKE '%test%'")
		table.insert(conditions, "NAME NOT LIKE '%darkmoon prize%'")
		table.insert(conditions, "NAME NOT LIKE '%frostmourne%'")
		table.insert(conditions, "NAME NOT LIKE '%codex%'")
		table.insert(conditions, "NAME NOT LIKE '%the fall of ameth%'")
		table.insert(conditions, "NAME NOT LIKE '%frostwolf artichoke%'")
		table.insert(conditions, "NAME NOT LIKE '%symbol of kings%'")
		table.insert(conditions, "NAME NOT LIKE '%symbol of divinity%'")
		table.insert(conditions, "NAME NOT LIKE '%word of thawing%'")
		table.insert(conditions, "NAME NOT LIKE '%grimoire%'")
		table.insert(conditions, "NAME NOT LIKE '%deprecated%'")
		table.insert(conditions, "NAME NOT LIKE '%cowardly flight%'")
		table.insert(conditions, "NAME NOT LIKE '%book%'")
		table.insert(conditions, "NAME NOT LIKE '%libram%'")
		table.insert(conditions, "NAME NOT LIKE '%brazie''s%'")
		table.insert(conditions, "NAME NOT LIKE '%guide%'")
		table.insert(conditions, "NAME NOT LIKE '%glyphed breastplate%'")
		table.insert(conditions, "NAME NOT LIKE '%weak flux%'")
		table.insert(conditions, "NAME NOT LIKE '%walnut stock%'")
		table.insert(conditions, "NAME NOT LIKE '%virtuoso inking%'")
		table.insert(conditions, "NAME NOT LIKE '%dictionary%'")
		table.insert(conditions, "NAME NOT LIKE '%Omar%'")
		table.insert(conditions, "NAME NOT LIKE '%depleted%'")
		table.insert(conditions, "NAME NOT LIKE '%bottomless inscription bag%'")
		table.insert(conditions, "NAME NOT LIKE '% Crate %' AND NAME NOT LIKE 'Crate %' AND NAME NOT LIKE '% Crate'")
		table.insert(conditions, "NAME NOT LIKE '%90 Epic%'")
		table.insert(conditions, "NAME NOT LIKE '%90 Blue%'")
		table.insert(conditions, "NAME NOT LIKE '%90 Green%'")
		-- Some quest items that show up despite the quest filters
		table.insert(conditions, "NAME NOT LIKE '%blood shard%'")
		table.insert(conditions, "NAME NOT LIKE '%dampscale basilisk eye%'")
		table.insert(conditions, "NAME NOT LIKE '%evil bat eye%'")
		table.insert(conditions, "NAME NOT LIKE '%package%'")
		table.insert(conditions, "NAME NOT LIKE '%signet of beckoning%'")
		table.insert(conditions, "NAME NOT LIKE '%silithid carapace%'")
		table.insert(conditions, "NAME NOT LIKE '%smoke beacon%'")
		table.insert(conditions, "NAME NOT LIKE '%snickerfang jowl%'")
		table.insert(conditions, "NAME NOT LIKE '%mojo%'")
		table.insert(conditions, "NAME NOT LIKE '%singed%'")
		-- Obsolete item class-subclass combinations
		table.insert(conditions, "NOT (class = 8 and subclass = 0)")
		table.insert(conditions, "NOT (class = 10 and subclass = 0)")
		table.insert(conditions, "NOT (class = 11 and subclass = 0)")
		table.insert(conditions, "NOT (class = 11 and subclass = 1)")
	end

	if not AllowBindOnAccount then
		table.insert(conditions, "(flags & 134217728) = 0")
	end

	if MinLevelConsumables then
		table.insert(conditions, "NOT (class = 0 AND RequiredLevel < " .. MinLevelConsumables .. ")")
	end

	if MinLevelGear then
		table.insert(conditions, "NOT (class = 4 AND RequiredLevel < " .. MinLevelGear .. ")")
		table.insert(conditions, "NOT (class = 2 AND RequiredLevel < " .. MinLevelGear .. ")")
	end

	if #conditions > 0 then
		ItemTemplateQuery = ItemTemplateQuery .. " WHERE " .. table.concat(conditions, " AND ")
	end
end

local function CheckAuctions(houseId, callback)
    CharDBQueryAsync(string.format("SELECT COUNT(*) FROM auctionhouse WHERE itemowner IN (%s) and houseid = %d", botList, houseId),
	function(countResult)
		if countResult then
			local count = countResult:GetUInt64(0)
			postedAuctions[houseId] = count
			callback(count)
		end
	end)
end

function bitAnd(a, b)
    local result = 0
    local shift = 0
    while a > 0 or b > 0 do
        -- Check the least significant bit of both numbers
        if a % 2 == 1 and b % 2 == 1 then
            result = result + 2^shift
        end
        -- Right shift both numbers by 1 (essentially dividing by 2)
        a = math.floor(a / 2)
        b = math.floor(b / 2)
        shift = shift + 1
    end
    return result
end

-- Helper function to convert Quality number to string key
local function getQualityString(Quality)
    local QualityStrings = {
        [0] = "Gray/Poor",
        [1] = "White/Common",
        [2] = "Green/Uncommon",
        [3] = "Blue/Rare",
        [4] = "Purple/Epic",
        [5] = "Orange/Legendary",
        [6] = "Red/Artifact",
        [7] = "Gold/Heirloom"
    }
    return QualityStrings[Quality]
end

local function SelectRandomItems()
    -- First, group items by their category and Quality
    local groupedItems = {
        Gear = {},
        Mats = {},
        Glyph = {},
        Projectile = {},
        Other = {}
    }
    
	-- Populate the groups
	for _, item in pairs(itemCache) do
		if item.class == 2 or item.class == 4 then
			local Quality = item.Quality
			groupedItems.Gear[Quality] = groupedItems.Gear[Quality] or {}
			local weight = ItemWeights.Gear[getQualityString(Quality)]
			for i = 1, weight do
				table.insert(groupedItems.Gear[Quality], item)
			end
		elseif item.class == 7 then
			local Quality = item.Quality
			groupedItems.Mats[Quality] = groupedItems.Mats[Quality] or {}
			local weight = ItemWeights.Mats[getQualityString(Quality)]
			for i = 1, weight do
				table.insert(groupedItems.Mats[Quality], item)
			end
		elseif item.class == 6 then
			for i = 1, ItemWeights.Projectile do
				table.insert(groupedItems.Projectile, item)
			end
		elseif item.class == 16 then
			for i = 1, ItemWeights.Glyph do
				table.insert(groupedItems.Glyph, item)
			end
		else
			for i = 1, ItemWeights.Other do
				table.insert(groupedItems.Other, item)
			end
		end
	end
    
    local selectedItems = {}
    for i = 1, ActionsPerCycle do
        -- Calculate total weight each time as groups may be emptied
        local totalWeight = 0
        local weightMap = {}
        
        -- Add weights for Gear qualities that still have items
        for Quality, items in pairs(groupedItems.Gear) do
            if #items > 0 then
                local weight = ItemWeights.Gear[getQualityString(Quality)]
                if weight > 0 then
                    totalWeight = totalWeight + weight
                    table.insert(weightMap, {
                        weight = weight,
                        items = items,
                        cumWeight = totalWeight
                    })
                end
            end
        end
        
        -- Add weights for Mats qualities that still have items
        for Quality, items in pairs(groupedItems.Mats) do
            if #items > 0 then
                local weight = ItemWeights.Mats[getQualityString(Quality)]
                if weight > 0 then
                    totalWeight = totalWeight + weight
                    table.insert(weightMap, {
                        weight = weight,
                        items = items,
                        cumWeight = totalWeight
                    })
                end
            end
        end
        
        -- Add weight for Glyphs if any remain
        if #groupedItems.Glyph > 0 then
            totalWeight = totalWeight + ItemWeights.Glyph
            table.insert(weightMap, {
                weight = ItemWeights.Glyph,
                items = groupedItems.Glyph,
                cumWeight = totalWeight
            })
        end
		
        -- Add weight for Projectiles if any remain
        if #groupedItems.Projectile > 0 then
            totalWeight = totalWeight + ItemWeights.Projectile
            table.insert(weightMap, {
                weight = ItemWeights.Projectile,
                items = groupedItems.Projectile,
                cumWeight = totalWeight
            })
        end
        
        -- Add weight for Other if any remain
        if #groupedItems.Other > 0 then
            totalWeight = totalWeight + ItemWeights.Other
            table.insert(weightMap, {
                weight = ItemWeights.Other,
                items = groupedItems.Other,
                cumWeight = totalWeight
            })
        end
        
        if totalWeight <= 0 then break end
        
        -- Select a group based on weight
        local rand = math.random() * totalWeight
        for _, entry in ipairs(weightMap) do
            if rand <= entry.cumWeight then
                -- Select random item from the chosen group
                local items = entry.items
                local itemIndex = math.random(1, #items)
                table.insert(selectedItems, items[itemIndex])
                table.remove(items, itemIndex)
                break
            end
        end
    end
    
    return selectedItems
end

---------------------------------------------------------------------------------
-- Cost Formulas
---------------------------------------------------------------------------------

function ChooseCostFormula(formulaNum, item)
    -- Set up base modifiers
    local q if item.Quality == 0 then q = 1 elseif item.Quality == 3 then q = 2.2 else q = item.Quality end
    local p if item.BuyPrice == 0 then if item.ItemLevel > 150 then p = item.ItemLevel/30 else p = 1 end elseif item.class == 2 then p = item.BuyPrice * 0.4 else p = item.BuyPrice * 0.8 end
    local s if item.SellPrice == 0 then if item.ItemLevel > 150 then s = item.ItemLevel/30 else s = 1 end elseif item.class == 2 then s = item.SellPrice * 0.4 else s = item.SellPrice * 0.8 end
    local l if item.ItemLevel == 0 then l = 1 elseif item.ItemLevel > 226 then l = item.ItemLevel * 2.5 else l = item.ItemLevel end
							
    if AHBotItemDebug then
        print("- Quality (q) type:", type(q), "Value:", q)
        print("- BuyPrice (p) type:", type(p), "Value:", p)
        print("- SellPrice (s) type:", type(s), "Value:", s)
        print("- ItemLevel (l) type:", type(l), "Value:", l)
        print("- Entry type:", type(item.entry), "Value:", item.entry)
    end
	
    -- Choose formula based on input
    if formulaNum == 1 then
        local price = (q / 3 * p / 10 * l * 1.2)
        
        -- Cap weapons at 2M ± 20%
        if item.class == 2 and price > 2000000 then
            local variance = 2000000 * 0.05
            price = 2000000 + math.random(-variance, variance)
        elseif item.entry == 50182 then -- Blood Queen's Choker should probably be more expensive than other BoEs
			price = price * 3
		end
        
        return price
    elseif formulaNum == 2 then
        return (q * p * s * l * item.entry) / 100000
    elseif formulaNum == 3 then
        return (q * q * l * item.RequiredLevel * 1.5) * 100
    elseif formulaNum == 4 then
        return ((q + l) * (item.RequiredLevel + 50) * (p + s) / 1000) * 
               (item.ItemLevel > 200 and 2 or 1)
    elseif formulaNum == 5 then
        local qualityMod = q * (item.Quality >= 3 and 1.5 or 1)
        local levelMod = (item.RequiredLevel / 10) * (item.ItemLevel / 50)
        local priceMod = ((p + s) / 1000) * (item.BuyPrice > 100000 and 1.3 or 1)
        return qualityMod * levelMod * priceMod * 10000
    else
        return math.random(1000, 1000000)
    end
end

---------------------------------------------------------------------------------
-- AH Bot Buyer Script
---------------------------------------------------------------------------------

local function AHBot_BuyAuction()
    local query
    if BotsBuyFromBots then
        query = string.format("SELECT id, itemguid, houseid, itemowner, buyoutprice, buyguid, lastbid, startbid, time FROM auctionhouse WHERE houseid IN (%s) LIMIT %d", houseList, ActionsPerCycle)
        if AHBotActionDebug then print("[Eluna AH Bot Debug]: Buyer - Starting buy cycle including bot sellers") end
    else
        query = string.format("SELECT id, itemguid, houseid, itemowner, buyoutprice, buyguid, lastbid, startbid, time FROM auctionhouse WHERE itemowner NOT IN (%s) AND houseid IN (%s) LIMIT %d", botList, houseList, ActionsPerCycle)
        if AHBotActionDebug then print("[Eluna AH Bot Debug]: Buyer - Starting buy cycle excluding bot sellers") end
    end
    
	CharDBQueryAsync(query, function(results)
		if not results then if BuyOnStartup and SellOnStartup then BuyOnStartup = false SendMessageToGMs("No eligible items to buy. Loading in new auctions...") RunCommand("reload auctions") end return end
		
		local tempResults = {}
		local auctionResults = {}
		
		-- First, store all results in temporary table to not gum up the query handling
		repeat
			table.insert(tempResults, {
				id = results:GetUInt32(0),
				itemguid = results:GetUInt32(1),
				houseid = results:GetUInt32(2),
				itemowner = results:GetUInt32(3),
				buyoutprice = results:GetUInt32(4),
				buyguid = results:GetUInt32(5),
				lastbid = results:GetUInt32(6),
				startbid = results:GetUInt32(7),
				bidtime = results:GetUInt32(8)
			})
		until not results:NextRow() or #tempResults >= ActionsPerCycle
		BuyOnStartup = false
		
		-- Then process the temporary table to remove entries we don't want to place bids/buyouts on
		if DisableBidFight then
			for _, result in ipairs(tempResults) do
				if result.buyguid == 0 then -- Don't do anything if the auction already has a bidder
					table.insert(auctionResults, result)
				end
			end
		else
			auctionResults = tempResults
		end
		
        if AHBotActionDebug then print("[Eluna AH Bot Debug]: Buyer - Found " .. count .. " potential auctions to process") end

        local itemGuids = {}
        for _, auction in ipairs(auctionResults) do
            table.insert(itemGuids, auction.itemguid)
        end

        local itemQuery = string.format("SELECT guid, itemEntry FROM item_instance WHERE guid IN (%s)", table.concat(itemGuids, ","))

        CharDBQueryAsync(itemQuery, function(itemResults)
            if not itemResults then return end
            
            local itemEntries = {}
            repeat
                local guid = itemResults:GetUInt32(0)
                local itemEntry = itemResults:GetUInt32(1)
                itemEntries[guid] = itemEntry
            until not itemResults:NextRow()
            
            local underpricedItems = {}
            for _, item in pairs(itemCache) do
                if AHBotItemDebug then print("[Eluna AH Bot Item Debug]: Evaluating item " .. item.entry .. " for price calculation") end
                
                local validItem = false
                if ItemLevelLimit then
                    if item.ItemLevel < ItemLevelLimit then 
                        validItem = true 
                        if AHBotItemDebug then print("[Eluna AH Bot Item Debug]: Item " .. item.entry .. " meets level requirement of " .. ItemLevelLimit) end
                    end
                end

                if validItem then
                    if AHBotItemDebug then print("[Eluna AH Bot Item Debug]: Calculating price for valid item " .. item.entry) end
                    local randomBot = AHBots[math.random(1, #AHBots)]
                    local cost = ChooseCostFormula(CostFormula, item)

                    cost = cost * BotsPriceTolerance
                    if cost < 200000 then cost = math.random(50000, 250000) end
                    if AHBotItemDebug then print("[Eluna AH Bot Item Debug]: Final adjusted cost for item " .. item.entry .. ": " .. cost) end

                    for _, auction in ipairs(auctionResults) do
                        if itemEntries[auction.itemguid] == item.entry and auction.buyoutprice < cost then
                            if AHBotItemDebug then print("[Eluna AH Bot Item Debug]: Buyer - Found underpriced item " .. item.entry .. " at " .. auction.buyoutprice .. " vs calculated " .. cost) end
                            table.insert(underpricedItems, {
                                entry = item.entry,
                                currentPrice = auction.buyoutprice,
                                calculatedValue = cost,
                                auctionId = auction.id
                            })
                        end
                    end
                end
            end

            if AHBotActionDebug then print("[Eluna AH Bot Debug]: Buyer - Found " .. #underpricedItems .. " underpriced items to roll buyout/bid on.") end

            local transactions = {}
            for _, item in ipairs(underpricedItems) do
                if AHBotItemDebug then print("[Eluna AH Bot Debug]: Processing transaction chances for item " .. item.entry) end
                local bidRoll = math.random(1, 100)
                local buyoutRoll = math.random(1, 100)
                local bidChance = bidRoll <= PlaceBidChance
                local buyoutChance = buyoutRoll <= PlaceBuyoutChance

                if buyoutRoll + bidRoll > 100 then
                    bidRoll = 100 - buyoutRoll
                    bidChance = bidRoll <= PlaceBidChance
                    if AHBotItemDebug then print("[Eluna AH Bot Debug]: Adjusted bid roll for item " .. item.entry .. " to " .. bidRoll) end
                end

                local matchingAuction
                for _, auction in ipairs(auctionResults) do
                    if auction.id == item.auctionId then
                        matchingAuction = auction
                        break
                    end
                end

				if matchingAuction then
					local transactionType = nil
					if buyoutRoll <= PlaceBuyoutChance then
						transactionType = "buyout"
					elseif bidRoll <= PlaceBidChance then
						transactionType = "bid"
					end

					if transactionType then
						local price
						
						if transactionType == "buyout" then
							price = matchingAuction.buyoutprice
						else  -- bid
							local minBid = math.max(matchingAuction.startbid * 1.10, matchingAuction.buyoutprice * 0.60)
							local maxBid = matchingAuction.buyoutprice * 0.95

							if minBid >= maxBid then  -- If no valid bid range exists, default to  buyout
								transactionType = "buyout"
								price = matchingAuction.buyoutprice
							else
								price = math.random(minBid, maxBid)
							end
						end
						
						table.insert(transactions, {
							transactionType = transactionType,
							entry = item.entry,
							itemGuid = matchingAuction.itemguid,
							auctionId = matchingAuction.id,
							itemOwner = matchingAuction.itemowner,
							price = price,
							houseid = matchingAuction.houseid
						})
					end
				end
            end
			if #transactions > 0 then
				local query = "UPDATE auctionhouse SET "
				local ids = {}
				local buyguidCases = {}
				local lastbidCases = {}
				local timeCases = {}

				for _, transaction in ipairs(transactions) do
					local randomBot = AHBots[math.random(1, #AHBots)]
					table.insert(buyguidCases, "WHEN " .. transaction.auctionId .. " THEN " .. randomBot)
					table.insert(lastbidCases, "WHEN " .. transaction.auctionId .. " THEN " .. transaction.price)
					table.insert(ids, transaction.auctionId)

					if transaction.transactionType == "buyout" then
						table.insert(timeCases, "WHEN " .. transaction.auctionId .. " THEN " .. os.time())
					else
						table.insert(timeCases, "WHEN " .. transaction.auctionId .. " THEN time")
					end
				end

				query = query .. "buyguid = CASE id " .. table.concat(buyguidCases, " ") .. " END, "
				query = query .. "lastbid = CASE id " .. table.concat(lastbidCases, " ") .. " END, "
				query = query .. "time = CASE id " .. table.concat(timeCases, " ") .. " END "
				query = query .. "WHERE id IN(" .. table.concat(ids, ",") .. ")"

				CharDBQueryAsync(query, function()
					SendMessageToGMs("Reloading auctions cache to pick up new bot transactions...")
					RunCommand("reload auctions")
					if AHBotActionDebug then print("[Eluna AH Bot Debug]: Buyer - Finished placing " .. #transactions .. " buyouts/bids.") end
				end)
			end
		end)
    end)
end

---------------------------------------------------------------------------------
-- AH Bot Seller Script
---------------------------------------------------------------------------------

local currentHouse = 0

local function AddAuctions(specificHouse)
	local houseId = 0
	
	if specificHouse then currentHouse = specificHouse end
	
	if currentHouse == 15 or currentHouse == 13 or currentHouse == 9 or currentHouse == 7 then houseId = 7
	elseif currentHouse == 8 or currentHouse == 6 then houseId = 6
	elseif currentHouse == 2 then houseId = 2 end
	
	if AHBotActionDebug then print("[Eluna AH Bot Debug]: Seller - Processing auctions for house ID: " .. houseId) end
	
	CheckAuctions(houseId, function(auctionCount) -- Check how many auctions posted by the AH bot are on the AH
		if (auctionCount < MinAuctions) or (specificHouse or ((auctionCount < MaxAuctions) and (math.random(100) <= RepopulationChance))) then
			local selectedItems = SelectRandomItems()
			if AHBotActionDebug then print("[Eluna AH Bot Debug]: Seller - Item selection complete.") end
	
			CharDBQueryAsync("SELECT MAX(guid) FROM item_instance", function(itemResult)
				local lastItemId = itemResult:GetUInt32(0)
				if AHBotActionDebug then print("[Eluna AH Bot Debug]: Seller - Found start item GUID for next batch of instantiations: ".. lastItemId) end
				
				CharDBQueryAsync("SELECT MAX(id) FROM auctionhouse", function(auctionResult)
					local lastAuctionId = auctionResult:GetUInt32(0)
					if AHBotActionDebug then print("[Eluna AH Bot Debug]: Seller - Found start auction ID for next batch of inserts: " .. lastAuctionId) end
					
					local itemQueryParts = {}
					local auctionQueryParts = {}
					local auctionCount = 0
					
					for _, item in ipairs(selectedItems) do
						if AHBotItemDebug then print("[Eluna AH Bot Item Debug]: Processing item "..item.name) end
						local isAllowed = false

						if houseId == 7 or item.race == 2147483647 or item.race == -1 then 
							isAllowed = true
						elseif houseId == 2 then -- Alliance AH, check if horde race is present in item_template
							for _, race in ipairs(AllowedAllyRaces) do
								if (bitAnd(item.race, race) ~= 0) then 
									isAllowed = true
									break
								end
							end
						elseif houseId == 6 then -- Horde AH, check if ally race is present in item_template
							for _, race in ipairs(AllowedHordeRaces) do
								if (bitAnd(item.race, race) ~= 0) then
									isAllowed = true
									break
								end
							end
						end

						if not isAllowed then
							if AHBotItemDebug then print("[Eluna AH Bot Item Debug]: Removing item " .. item.name .. " from queue due to belonging to another faction than auction house ID "..houseId) end
						else
							auctionCount = auctionCount + 1
							lastItemId = lastItemId + 1
							lastAuctionId = lastAuctionId + 1
							
							local randomBot = AHBots[math.random(1, #AHBots)]
							
							local cost = ChooseCostFormula(CostFormula, item)

							local expireTime = os.time() + math.random(6 * 3600, 48 * 3600)

							-- Item type price adjustments
							if RecipePriceAdjustment then if item.class == 9 and not item.name:find("Design:") then cost = cost * RecipePriceAdjustment end end
							if GemPriceAdjustment then if item.class == 3 then cost = cost * GemPriceAdjustment * (1 + (math.random() * 0.4 - 0.2)) end end
							if UndervaluedItemAdjust then if cost < 50000 then if ((item.class == 7 and item.entry > 40000) or (item.name:find("VIII"))) and not (item.Quality > 2 or item.entry == 41511) then cost = cost * UndervaluedItemAdjust end end end -- Adjusts certain profession mats and scrolls if very cheap
							
							-- If cost calculation aimed too low, adjust with a randomized failsafe amount
							if not cost or cost < 1000 then cost = math.random(10000, 100000) end
							
							if item.class == 4 then
								if item.ItemLevel > 200 and item.InventoryType == 9 and item.bonding == 2 then if cost < 500000 then cost = cost * 100 end end -- EOV bracers
							end 
							
							if LowPriceFloor then
								if (((item.class == 15 and item.subclass == 2) or (item.class == 16)) and cost < 200000) then cost = LowPriceFloor * (math.random() * 0.6 + 0.7) end
							else
								if UndervaluedItemAdjust then if (((item.class == 15 and item.subclass == 2) or (item.class == 16)) and cost < 200000) then cost = cost * UndervaluedItemAdjust end end
							end
							
							-- Crafted by
							if item.craftedBy == 1 then item.craftedBy = randomBot end
							
							local stack = 1
							
							if item.class == 6 then
								if AlwaysMaxStackAmmo then
									stack = item.stackable
								end
							elseif StackedItemClasses then
								for _, itemClass in ipairs(StackedItemClasses) do
									if item.class == itemClass then
										if item.stackable > 10 then
											stack = math.ceil(math.random(8, item.stackable))
										else
											stack = math.ceil(math.random(1, item.stackable))
										end
									end
								end
							end
							
							cost = cost * stack
							
							if SellPriceVariance then
								cost = cost * math.random(1 - (SellPriceVariance/100), 1 + (SellPriceVariance/100))
							end
							
							if AdjustedAmmoPrices then
								if item.class == 6 then
									if item.Quality == 1 then cost = math.random(150,5000) end
									if item.Quality == 2 then cost = math.random(10000,100000) end
									if item.Quality == 3 then cost = math.random(100000,150000) end
									if item.Quality == 4 then cost = math.random(200000,350000) end
									if item.Quality == 5 then cost = math.random(350000,1000000) end
								end
							end

							-- Random stats
							local randomStats
							if ApplyRandomProperties then
								if item.RandomProperty > 0 then randomStats = item.RandomProperty -- Random property start
								elseif item.RandomSuffix > 0 then randomStats = (item.RandomSuffix) * -1 -- Random suffix start print("Suffixed item found: "..item.entry..". Stored randomStats value: "..randomStats)
								else randomStats = 0 -- Skip random stats handling
								end
							end
							
							local enchantString = "0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"
							
							if randomStats > 0 then -- Handle random properties
								local properties = ItemRandomProperty[randomStats]
								if properties then
									for _, property in ipairs(properties) do
										if math.random(0, 100) <= property.chance then
											local e1, e2, e3 = table.unpack(ItemRandomProperties[property.ench])
											enchantString = "0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "..e1.." 0 0 "..e2.." 0 0 "..e3.." 0 0 0 0 0 0 0 0 "
											randomStats = property.ench
											if AHBotItemDebug then print("[Eluna AH Bot Item Debug]: Item "..item.entry.." - Enchants found for "..property.ench..": "..e1..", "..e2..", "..e3) end
											break
										end
									end
								end
							end
							
							if randomStats < 0 then -- Handle random suffixes
								local suffixOptions = {}
								local suffixOption
								
								-- Caster items, require suffix 
								if item.InventoryType == 23 or item.InventoryType == 20 -- Held in off hands, robes (cloth chest)
								or (item.class == 2 and (item.subclass == 10 or item.subclass == 19))
								or (item.class == 4 and item.subclass == 1) then -- Stamina, spirit, int, spell power, protections etc.
									suffixOptions = {36, 37, 38, 39, 9, 15, 19, 26, 81, 84, 85, 31, 32, 33, 34, 35}
									
								elseif (item.class == 4 and item.subclass == 2) -- Leather and rogue/moonkin
								or (item.class == 2 and (
									item.subclass == 2 or item.subclass == 3 or item.subclass == 6 or
									item.subclass == 13 or item.subclass == 15 or item.subclass == 16 or 
									item.subclass == 17 or item.subclass == 18)) then -- Stamina, Agility. To-do: Boomie leather gear.
									suffixOptions = {50, 56, 63, 68, 69, 71, 74, 82, 84, 89, 91, 31, 32, 33, 34, 35}
									
								elseif (item.class == 4 and item.subclass == 3) then -- Mail gear, hunter/shaman
									suffixOptions = {91, 89, 86, 71, 69, 63, 67, 50, 31, 32, 33, 34, 35}
									
								elseif item.class == 2 or (item.class == 4 and -- Plate gear, remaining weapons
									(item.subclass == 4 or item.subclass == 6)) then -- Plate armor and shields
									suffixOptions = {92, 89, 86, 84, 68, 71, 72, 66, 62, 63, 43, 42, 41, 31, 32, 33, 34, 35}
								else -- Random stats failsafe
									suffixOption = math.random(49, 75)
								end
								
								-- Select a random suffix from the available options
								local selectedSuffix
								
								if suffixOption then
									selectedSuffix = suffixOption
								else
									selectedSuffix = suffixOptions[math.random(1, #suffixOptions)]
								end
								
								local e1, e2, e3, e4, e5 = table.unpack(ItemRandomSuffix[selectedSuffix].Enchantment)
								enchantString = "0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "..e1.." 0 0 "..e2.." 0 0 "..e3.." 0 0 "..e4.." 0 0 "..e5.." 0 0 "
								randomStats = selectedSuffix * -1
								if AHBotItemDebug then print("[Eluna AH Bot Item Debug]: Item "..item.entry.." - Enchants found for "..selectedSuffix..": "..e1..", "..e2..", "..e3..", "..e4..", "..e5) end
							end
							
							cost = math.floor(cost)
							
							local startBid = math.floor(cost * (math.random(51, 90) / 100))
							-- Add item_instance entry
							table.insert(itemQueryParts, "(" .. lastItemId .. ", " .. item.entry .. ", " .. randomBot .. ", " .. item.craftedBy .. ", 0, " .. stack .. ", 0, '" ..
								item.c1 .. " " .. item.c2 .. " " .. item.c3 .. " " .. item.c4 .. " " .. item.c5 .. "', 0, '"..enchantString.."', " ..
								randomStats .. ", " .. item.durability .. ", "..item.duration..", '')")

							-- Add auction entry
							table.insert(auctionQueryParts, string.format(
								"(%d, %d, %d, %d, %d, %d, 0, 0, %d, 1)",
								lastAuctionId, houseId, lastItemId, randomBot, cost, expireTime, startBid
							))
						end
					end
					-- We're nesting our next operations in async queries to ensure they don't overlap and are performed in rapid succession
					if #itemQueryParts > 0 then 
					
						local itemQuery = "INSERT INTO item_instance (guid, itemEntry, owner_guid, creatorGuid, giftCreatorGuid, count, duration, charges, flags, enchantments, randomPropertyId, durability, playedTime, text) VALUES " .. table.concat(itemQueryParts, ",")
						local auctionQuery = "INSERT INTO auctionhouse (id, houseid, itemguid, itemowner, buyoutprice, time, buyguid, lastbid, startbid, deposit) VALUES " .. table.concat(auctionQueryParts, ",")
						CharDBQueryAsync(itemQuery, function(results) -- Insert items in database first
							CharDBQueryAsync(auctionQuery, function(results) -- Once item inserts are complete, insert auctions
								if AHBotActionDebug then print("[Eluna AH Bot Debug]: Seller - " .. auctionCount .. " auctions added to auction house no. " .. houseId .. ".") end
								currentHouse = currentHouse - houseId
								
								if currentHouse == 0 then
									if BuyOnStartup then
										if AHBotActionDebug then print("[Eluna AH Bot Debug]: Seller - Done processing all included auction houses, proceeding to initiate buyers...") end
										AHBot_BuyAuction()
										SendMessageToGMs("AH bot sellers initiated. Starting buyers...")
										return
									end
									if AHBotActionDebug then print("[Eluna AH Bot Debug]: Seller - Done processing all included auction houses, instantiating auctions!") end
									SendMessageToGMs("Reloading auctions cache to pick up new bot auctions...")
									RunCommand("reload auctions") -- Instantiates auctions
									NextAHBotSellCycle = os.time() + AHSellTimer * 60 * 60
									return
								end
								if AHBotActionDebug then print("[Eluna AH Bot Debug]: Seller - Scheduling processing of next house ID.") end
								AddAuctions() -- Schedule next auction house
							end)
						end)
					end
				end)
			end)
		else
			if AHBotActionDebug then print("[Eluna AH Bot Debug]: Seller - Action house at capacity (Min auctions: "..MinAuctions..". Current auctions: ".. tostring(auctionCount) .." / " .. MaxAuctions .. "). No action taken, awaiting next cycle on ".. os.date("%H:%M", NextAHBotSellCycle) .. " server time.") end
			if BuyOnStartup then
				AHBot_BuyAuction()
			end
		end
	end)
end

local function AHBot_SellItems(specificHouse)
    if not EnabledAuctionHouses then EnabledAuctionHouses = {2, 6, 7} end
	if not specificHouse then
		for _, houseId in ipairs(EnabledAuctionHouses) do
			currentHouse = currentHouse + houseId
		end
	else
		currentHouse = specificHouse
	end
	AddAuctions(specificHouse)
end

---------------------------------------------------------------------------------
-- Initialize item_template cache and initial event scheduling
---------------------------------------------------------------------------------

local ItemTemplateSize = 0

CreateLuaEvent(function()
	WorldDBQueryAsync(ItemTemplateQuery, function(results)
		if AHBotActionDebug then print("[Eluna AH Bot]: Core - Caching item_template.") end
		if results then
			repeat
				local entry = results:GetUInt32(0)
				itemCache[entry] = {
					entry = entry,
					class = results:GetUInt32(1),
					subclass = results:GetUInt32(2),
					Quality = results:GetUInt32(3),
					BuyPrice = results:GetUInt32(4),
					SellPrice = results:GetUInt32(5),
					InventoryType = results:GetUInt32(6),
					AllowableClass = results:GetInt32(7),
					ItemLevel = results:GetUInt32(8),
					RequiredLevel = results:GetUInt32(9),
					RequiredSkill = results:GetUInt32(10),
					RequiredSkillRank = results:GetUInt32(11),
					stackable = results:GetUInt32(12),
					startquest = results:GetUInt32(13),
					bonding = results:GetUInt32(14),
					BagFamily = results:GetUInt32(15),
					flags = results:GetUInt32(16),
					name = results:GetString(17),
					durability = results:GetUInt32(18),
					ContainerSlots = results:GetUInt32(19),
					RandomProperty = results:GetInt32(20),
					c1 = results:GetInt32(21),
					c2 = results:GetInt32(22),
					c3 = results:GetInt32(23),
					c4 = results:GetInt32(24),
					c5 = results:GetInt32(25),
					duration = results:GetUInt32(26),
					race = results:GetInt32(27),
					RandomSuffix = results:GetInt32(28),
					craftedBy = 0
				}
				ItemTemplateSize = ItemTemplateSize + 1
			until not results:NextRow()
			if AHBotActionDebug then print("[Eluna AH Bot]: Core - Finished caching item_template. Valid items: "..ItemTemplateSize..".") end
			
			if SetAsCraftedBy then -- Split out of the query to not delay db ops
				for entry, item in pairs(itemCache) do
					for _, craftedItem in ipairs(craftedItems) do
						if entry == craftedItem then
							item.craftedBy = 1
							break
						end
					end
				end
			end
			
			if EnableSeller then
				WorldDBQueryAsync("SELECT * FROM item_enchantment_template", function(results)
					if results then
						-- Initialize the ItemRandomProperty table if it doesn't exist
						ItemRandomProperty = ItemRandomProperty or {}
						
						repeat
							local entry = results:GetUInt32(0)
							local ench = results:GetUInt32(1)
							local chance = results:GetFloat(2)
							-- Initialize the entry table only once
							if not ItemRandomProperty[entry] then
								ItemRandomProperty[entry] = {}
							end
							
							-- Add the new enchantment data
							table.insert(ItemRandomProperty[entry], {
								ench = ench,
								chance = chance
							})
						until not results:NextRow()
						
						if AHBotActionDebug then 
							print("[Eluna AH Bot Debug]: Seller - Finished caching item_enchantment_template.") 
						end
						
						if SellOnStartup then
							AHBot_SellItems()
						end
					end
				end)
			end
		end
	end)
end, StartupDelay + 100) -- The core may crash if we get MySQL locked from other scripts querying database on load/reload Eluna. Adding slight delay in case StartupDelay is 0.

if EnableSeller then
	AHBotSellEventId = CreateLuaEvent(AHBot_SellItems, AHSellTimer * 60 * 60 * 1000, 0)
	NextAHBotSellCycle = os.time() + AHSellTimer * 60 * 60
	if AHBotActionDebug then print("[Eluna AH Bot Debug]: Seller - AH Bot seller system initialized. Actions scheduled on every " .. AHSellTimer .. " hour(s).") end
end

if EnableBuyer then
	for _, entry in ipairs(EnabledAuctionHouses) do
		AHBotBuyEventId = CreateLuaEvent(AHBot_BuyAuction, AHBuyTimer * 65 * 60 * 1000, 0) -- 5 minutes after seller bots to not cause overlapping lag
		if AHBotActionDebug then print("[Eluna AH Bot Debug]: Buyer - AH Bot buyer system initialized. Actions scheduled on every " .. AHBuyTimer .. " hour(s).") end
	end
	if BuyOnStartup and not SellOnStartup then -- The seller will initiate buyers once done, if both are enabled, so here we must check is not SellOnStartup to not start overlapping buyers
		CreateLuaEvent(AHBot_BuyAuction, StartupDelay + 1000) -- Slight artificial delay in case StartupDelay is 0.
	end
end

---------------------------------------------------------------------------------
-- Management commands
---------------------------------------------------------------------------------

local function AHBot_Cmd(event, player, command)
	if not player then return end
	if command:find("ah") then
		if player:GetGMRank() < 1 then
			player:SendBroadcastMessage("You don't have access to this command.")
			return false
		end
	end
	local name = player:GetName()
	if command:lower() == "ahbot" or command == "ahbot options" or command == "ahbot help" then
		player:SendBroadcastMessage(" ")
		player:SendBroadcastMessage("[Eluna AH Bot]: Welcome to the Eluna AH bot menu. Possible subcommands:")
		player:SendBroadcastMessage(".ahbot info: Displays statistics about the auction house bot.")
		player:SendBroadcastMessage(".ahbot auctions expire <auction_house_ID/all>: Expires all auctions per house (2/6/7) or all houses.")
		player:SendBroadcastMessage(".ahbot auctions add: Force adds a batch of ".. ActionsPerCycle .." auctions to all auction houses.")
		player:SendBroadcastMessage(".ahbot auctions buy: Force buys a random batch of auctions from all auction houses.")
		player:SendBroadcastMessage(".ahbot stop: Removes the scheduled auction bot events.")
		player:SendBroadcastMessage(".ahbot start: Starts the auction bot, if stopped.")
		player:SendBroadcastMessage(".ahbot pause <hours>: Pauses the auction bot for the specified number of hours.")
		player:SendBroadcastMessage(".ahbot set batchsize <number>: Changes how many items the auction bots processes per cycle.")
		player:SendBroadcastMessage(".ahbot set buycycle <hours>: Changes how often the auction house bot checks the auction house to take action.")
		player:SendBroadcastMessage(".ahbot set sellcycle <hours>: Changes how often the auction house bot checks the auction house to take action.")
		return false
		
	elseif command:lower() == "ahbot info" then
		local auctionInfo = {}
		for houseId, count in pairs(postedAuctions) do
			if count and not (count == "0") then
				table.insert(auctionInfo, string.format("House ID: %d -> Auctions: %s", houseId, count))
			end
		end
		player:SendBroadcastMessage("[Eluna AH Bot]: ---------- INFO ----------")
		player:SendBroadcastMessage("Auction house IDs with active bots (2 = ally, 6 = horde, 7 = neutral): ".. houseList)
		player:SendBroadcastMessage("Active bot GUID lows: ".. botList)
		player:SendBroadcastMessage("Min bot auctions: "..MinAuctions..". Max bot auctions: "..MaxAuctions..".")
		player:SendBroadcastMessage("Number of possible items in auction house pool: ".. ItemTemplateSize)
		player:SendBroadcastMessage("Bot items on auction houses on last cycle: "..(table.concat(auctionInfo, ", ")))
		player:SendBroadcastMessage("Next auction house bot sell cycle (hours:minutes): ".. os.date("%H:%M", NextAHBotSellCycle))
		player:SendBroadcastMessage("Next auction house bot buy cycle: Every ".. 60 * AHBuyTimer .." minutes.")
		local status
		if AHBotSellEventId then status = "Online" else status = "Offline" end
		player:SendBroadcastMessage("Status auction house bot seller service: "..status)
		if AHBotBuyEventId then status = "Online" else status = "Offline" end
		player:SendBroadcastMessage("Status auction house bot buyer service: "..status)
		return false
		
	elseif command:lower() == "ahbot auctions expire" or command == "ahbot expire" or command == "ahbot auctions expire all" or command == "auctions expire"  then
		CharDBQueryAsync("UPDATE auctionhouse SET time = 1 WHERE itemowner IN (" .. botList .. ")", function(query)
			local player = GetPlayerByName(name)
			SendMessageToGMs("GM "..name.." has set all bot auctions to expire on next auction update. Reloading auctions cache...")
			RunCommand("reload auctions") -- Instantiates auctions
			print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." expired all auction houses' bot auctions.")	
		end)
		return false
	elseif command:lower() == "ahbot auctions expire 2" then
		CharDBQueryAsync("UPDATE auctionhouse SET time = 1 WHERE itemowner IN (" .. botList .. ") AND houseid = 2", function(query)
			local player = GetPlayerByName(name)
			SendMessageToGMs("GM "..name.." has set bot auctions on house ID 2 to expire on next auction update. Reloading auctions cache...")
			RunCommand("reload auctions") -- Instantiates auctions
			print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." expired bot auctions on auction house 2.")	
		end)
		return false
	elseif command:lower() == "ahbot auctions expire 6" then
		CharDBQueryAsync("UPDATE auctionhouse SET time = 1 WHERE itemowner IN (" .. botList .. ") AND houseid = 6", function(query)
			local player = GetPlayerByName(name)
			SendMessageToGMs("GM "..name.." has set bot auctions on house ID 6 to expire on next auction update. Reloading auctions cache...")
			RunCommand("reload auctions") -- Instantiates auctions
			print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." expired bot auctions on auction house 6.")	
		end)
		return false
	elseif command:lower() == "ahbot auctions expire 7" then
		CharDBQueryAsync("UPDATE auctionhouse SET time = 1 WHERE itemowner IN (" .. botList .. ") AND houseid = 7", function(query)
			local player = GetPlayerByName(name)
			SendMessageToGMs("GM "..name.." has set bot auctions on house ID 7 to expire on next auction update. Reloading auctions cache...")
			RunCommand("reload auctions") -- Instantiates auctions
			print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." expired bot auctions on auction house 7.")	
		end)
		return false
	
	elseif command:lower() == "ahbot auctions buy" or command == "ahbot buy" or command == "auctions buy" or command == "ahbot auction buy" or command == "auctions buy" then
		AHBot_BuyAuction()
		SendMessageToGMs("GM "..name.." is force buying " .. ActionsPerCycle .. " auctions from all auction houses.")
		print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." force bought auctions on all auction houses.")
		return false
		
	elseif command:lower() == "ahbot auctions add" or command == "ahbot auctions add all" or command == "ahbot auction add all" or command == "auctions add all" or command == "auction add all" then
		AHBot_SellItems(15)
		SendMessageToGMs("GM "..name.." has force added " .. ActionsPerCycle .. " auctions to all auction houses.")
		print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." force added auctions on all auction houses.")
		return false
	elseif command:lower() == "ahbot auctions add 2" then
		AHBot_SellItems(2)
		SendMessageToGMs("GM "..name.." has force added " .. ActionsPerCycle .. " auctions to auction house ID 2.")
		print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." force added auctions on auction house 2.")
		return false
	elseif command:lower() == "ahbot auctions add 6" then
		AHBot_SellItems(6)
		SendMessageToGMs("GM "..name.." has force added " .. ActionsPerCycle .. " auctions to auction house ID 6.")
		print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." force added auctions on auction house 6.")
		return false
	elseif command:lower() == "ahbot auctions add 7" then
		AHBot_SellItems(7)
		SendMessageToGMs("GM "..name.." has force added " .. ActionsPerCycle .. " auctions to auction house ID 7.")
		print("[Eluna AH Bot]: Player "..player:GetGUIDLow().." force added auctions on auction house 7.")
		return false
		
	elseif command:lower() == "ahbot stop" then
		player:SendBroadcastMessage("[Eluna AH Bot]: Syntax error. Please use either '.ahbot stop sell' or '.ahbot stop buy'.")
		return false
	elseif command:lower() == "ahbot stop sell" then
		RemoveEventById(AHBotSellEventId)
		AHBotSellEventId = nil
		NextAHBotSellCycle = nil
		SendMessageToGMs("GM "..name.." has force stopped the auction house seller on all auction houses.")
		print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." just stopped the auction bot seller.")
		return false
	elseif command:lower() == "ahbot stop buy" then
		RemoveEventById(AHBotBuyEventId)
		AHBotBuyEventId = nil
		NextAHBotBuyCycle = nil
		SendMessageToGMs("GM "..name.." has force stopped the auction house buyer on all auction houses.")
		print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." just stopped the auction bot buyer.")
		return false
		
	elseif command:lower() == "ahbot pause" then
		player:SendBroadcastMessage("[Eluna AH Bot]: Invalid pause time! Please specify a duration between 1 to 24 hours.")
		return false
	elseif command:find("ahbot pause ") then
		local _, _, pauseTime = command:find("ahbot pause (%d+)")
		if pauseTime and tonumber(pauseTime) >= 1 and tonumber(pauseTime) <= 24 then
			pauseTime = tonumber(pauseTime)
			RemoveEventById(AHBotSellEventId)
			RemoveEventById(AHBotBuyEventId)
			AHBotBuyEventId = CreateLuaEvent(AHBot_BuyAuction, AHBuyTimer * pauseTime * 65 * 60 * 1000, 0)
			AHBotSellEventId = CreateLuaEvent(AHBot_SellItems, AHSellTimer * pauseTime * 60 * 60 * 1000, 0)
			NextAHBotSellCycle = os.time() + pauseTime * 60 * 60
			SendMessageToGMs("GM "..name.." has paused all auction house bots for "..pauseTime.." hours.")
			print("[Eluna AH Bot]: Player "..player:GetGUIDLow().." just paused the auction bot for " .. pauseTime .. " hours.")
		else
			player:SendBroadcastMessage("[Eluna AH Bot]: Invalid pause time! Please specify a number between 1 and 24.")
		end
		return false
		
	elseif command:find("ahbot set batchsize ") then
		local batchsize = tonumber(command:match("ahbot%s+set%s+batchsize%s+(%d+)"))
		if batchsize and tonumber(batchsize) >= 1 and tonumber(batchsize) <= MaxAuctions then
			batchsize = tonumber(batchsize)
			ActionsPerCycle = batchsize
			SendMessageToGMs("GM "..name.." has set the auction house bots' batch size to "..batchsize..".")
			print("[Eluna AH Bot]: Player "..player:GetGUIDLow().." just changed the auction bot's batch size to "..batchsize..".")
		else
			player:SendBroadcastMessage("[Eluna AH Bot]: Invalid batch size! Please specify a number between 1 and "..MaxAuctions..".")
		end
		return false
		
	elseif command:find("ahbot set sellcycle ") then
		local hours = tonumber(command:match("ahbot%s+set%s+sellcycle%s+(%d+)"))
		if hours and tonumber(hours) >= 1 and tonumber(hours) <= 48 then
			hours = tonumber(hours)
			AHSellTimer = hours
			SendMessageToGMs("GM "..name.." has set the auction house bot's sell cycle time has been set to "..hours.." hours. Next cycle is in "..hours.." hour(s) from now.")
			print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." just changed the auction bot's sell cycle time to "..hours.." hour(s).")
		else
			player:SendBroadcastMessage("[Eluna AH Bot]: Invalid sell cycle time! Please specify a number between 1 and 48.")
		end
		return false
	elseif command:find("ahbot set buycycle ") then
		local hours = tonumber(command:match("ahbot%s+set%s+buycycle%s+([%d%.]+)"))
		if hours and hours >= 0.1 and hours <= 48 then
			AHBuyTimer = hours
			SendMessageToGMs("GM "..name.." has set the auction house bot's buy cycle time has been set to %.1f minutes. Next cycle is in %.1f minutes from now.", 60 * hours, 60 * hours)
			print(string.format("[Eluna AH Bot]: GM %d just changed the auction bot's buy cycle time to %.1f minutes.", player:GetGUIDLow(), 60 * hours))
		else
			player:SendBroadcastMessage("[Eluna AH Bot]: Invalid buy cycle time! Please specify a number between 0.1 and 48.")
		end
		return false
			
	elseif command:lower() == "ahbot start" then
		player:SendBroadcastMessage("[Eluna AH Bot]: Incorrect syntax. Use either '.ahbot start sell' or '.ahbot start buy'.")
		return false
	elseif command:lower() == "ahbot start buy" then
		if not AHBotBuyEventId then
			AHBotBuyEventId = CreateLuaEvent(AHBot_BuyAuction, AHBuyTimer * 65 * 60 * 1000, 0)
			NextAHBotBuyCycle = os.time() + AHBuyTimer * 60 * 60
			SendMessageToGMs("GM "..name.." has just started the auction house buyer bot.")
			print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." just started the auction bot buyer.")
		else
			player:SendBroadcastMessage("[Eluna AH Bot]: Auction house buyer has already been started. No action taken.")
		end
		return false
	elseif command:lower() == "ahbot start sell" then
		if not AHBotSellEventId then
			AHBotSellEventId = CreateLuaEvent(AHBot_SellItems, AHSellTimer * 60 * 60 * 1000, 0)
			NextAHBotSellCycle = os.time() + AHSellTimer * 60 * 60
			SendMessageToGMs("GM "..name.." has just started the auction house seller bot.")
			print("[Eluna AH Bot]: GM "..player:GetGUIDLow().." just started the auction bot seller.")
		else
			player:SendBroadcastMessage("[Eluna AH Bot]: Auction house seller has already been started. No action taken.")
		end
		return false
	
	elseif command:find("ahbot.+") then
		player:SendBroadcastMessage("[Eluna AH Bot]: Syntax error. Type .ahbot to see available commands.")
		return false
	end
end

RegisterPlayerEvent(42, AHBot_Cmd)

---------------------------------------------------------------------------------
-- Announce login
---------------------------------------------------------------------------------

if AnnounceOnLogin then
	local function OnPlayerLogin(event, player)
		player:SendBroadcastMessage("This server runs the |cFFD8D8E6[Eluna AH Bot]|r module by mostlynick :)")
		if player:GetGMRank() > 0 then
			player:SendBroadcastMessage("|cFFD8D8E6[Eluna AH Bot GM]|r: Type '.ahbot' to manage, set cache settings, and display statistics.")
		end
	end
	RegisterPlayerEvent(3, OnPlayerLogin)
end

---------------------------------------------------------------------------------
-- End of script
---------------------------------------------------------------------------------
